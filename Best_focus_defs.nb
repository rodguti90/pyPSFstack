(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     90951,       2193]
NotebookOptionsPosition[     84858,       2086]
NotebookOutlinePosition[     85322,       2103]
CellTagsIndexPosition[     85279,       2100]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Derivation of criteria for best focus", "Title",
 CellChangeTimes->{{3.891586495349483*^9, 
  3.891586505796176*^9}},ExpressionUUID->"59ad2c26-9444-4104-9425-\
54a8a1acfd9b"],

Cell["\<\
Define the wavefront error and its approximation up to fourth order\
\>", "Text",
 CellChangeTimes->{{3.891586513884419*^9, 
  3.891586538166326*^9}},ExpressionUUID->"5ca0b3ac-9e01-4482-8a25-\
4c1cdde36ed0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"abeW", "[", 
   RowBox[{"u_", ",", "nr_", ",", "\[Alpha]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["1", "nr"], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox[
       RowBox[{"(", " ", 
        RowBox[{"nr", " ", "u"}], ")"}], "2"]}]]}], "-", " ", 
   RowBox[{"\[Alpha]", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["u", "2"]}]]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"abeW4th", "[", 
   RowBox[{"u_", ",", "nr_", ",", "\[Alpha]_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", "nr"], "-", "\[Alpha]", "-", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"nr", "-", "\[Alpha]"}], ")"}], 
    SuperscriptBox["u", "2"]}], "-", 
   RowBox[{
    FractionBox["1", "8"], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["nr", "3"], "-", "\[Alpha]"}], ")"}], 
    SuperscriptBox["u", "4"]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"abeW6th", "[", 
   RowBox[{"u_", ",", "nr_", ",", "\[Alpha]_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", "nr"], "-", "\[Alpha]", "-", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"nr", "-", "\[Alpha]"}], ")"}], 
    SuperscriptBox["u", "2"]}], "-", 
   RowBox[{
    FractionBox["1", "8"], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["nr", "3"], "-", "\[Alpha]"}], ")"}], 
    SuperscriptBox["u", "4"]}], "-", 
   RowBox[{
    FractionBox["1", "16"], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["nr", "5"], "-", "\[Alpha]"}], ")"}], " ", 
    SuperscriptBox["u", "6"]}]}]}]}], "Input",
 CellChangeTimes->{{3.891664943185691*^9, 3.891665015366991*^9}, {
  3.891665179994274*^9, 3.891665192043912*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"14fe8ff0-3b7c-4a1e-bd23-fef16bcbffcf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"abeW", "[", 
    RowBox[{"u", ",", "nr", ",", "\[Alpha]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"u", ",", "0", ",", "6"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.891587700747219*^9, 3.8915877285838842`*^9}, 
   3.891587901429203*^9, 3.891664987385065*^9},
 CellLabel->
  "In[192]:=",ExpressionUUID->"66ac7375-ea5d-498e-8148-de3ddeb1acbc"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "nr"], "-", "\[Alpha]"}], ")"}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "nr"}], "+", "\[Alpha]"}], ")"}], " ", 
    SuperscriptBox["u", "2"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["nr", "3"], "8"]}], "+", 
      FractionBox["\[Alpha]", "8"]}], ")"}], " ", 
    SuperscriptBox["u", "4"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["nr", "5"], "16"]}], "+", 
      FractionBox["\[Alpha]", "16"]}], ")"}], " ", 
    SuperscriptBox["u", "6"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "u", "]"}], "7"],
    SeriesData[$CellContext`u, 0, {}, 0, 7, 1],
    Editable->False]}],
  SeriesData[$CellContext`u, 
   0, {$CellContext`nr^(-1) - $CellContext`\[Alpha], 0, 
    Rational[1, 2] (-$CellContext`nr + $CellContext`\[Alpha]), 0, 
    Rational[-1, 8] $CellContext`nr^3 + Rational[1, 8] $CellContext`\[Alpha], 
    0, Rational[-1, 16] $CellContext`nr^5 + 
    Rational[1, 16] $CellContext`\[Alpha]}, 0, 7, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.8915877239525433`*^9, 3.891587729437675*^9}, 
   3.8915879017585077`*^9, 3.89166498830903*^9, 3.891665196069345*^9},
 CellLabel->
  "Out[192]=",ExpressionUUID->"3b25f9de-1187-4e00-ac47-620e54f5bf64"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Paraxial (second order W rms)", "Subsubsection",
 CellChangeTimes->{{3.8915873736144037`*^9, 
  3.891587387547757*^9}},ExpressionUUID->"13ac0d7c-0ed8-4d26-bdc7-\
87ecd94901ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getParaxial", "[", "nr_", "]"}], ":=", "nr"}]], "Input",
 CellChangeTimes->{{3.89158739543491*^9, 3.891587399253067*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"1ab65db4-53b6-4a60-9495-bc514c00fbd5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fourth order W rms", "Subsubsection",
 CellChangeTimes->{{3.8915256412649097`*^9, 
  3.891525649478364*^9}},ExpressionUUID->"65b9b499-f0a9-4327-a3e0-\
4618a0d1dbdf"],

Cell["\<\
Note that the nr multiplying the terms is there because the definition is \
with u running from 0 to 1 (the SA).\
\>", "Text",
 CellChangeTimes->{{3.891588045055072*^9, 3.891588080440371*^9}, 
   3.89158838461668*^9},ExpressionUUID->"a8514146-93fb-4d68-b2c0-\
1cbcb21865e2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Wmean", "[", 
    RowBox[{"\[Alpha]_", ",", "nr_"}], "]"}], "=", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nr", ">", "1"}], ",", 
       RowBox[{"\[Alpha]", "\[Element]", "Reals"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["nr", "2"], " ", 
         RowBox[{"abeW4th", "[", 
          RowBox[{"u", ",", "nr", ",", "\[Alpha]"}], "]"}], "u"}], ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "0", ",", 
          RowBox[{"1", "/", "nr"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "/", "\[Pi]"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"W2mean", "[", 
    RowBox[{"\[Alpha]_", ",", "nr_"}], "]"}], " ", "=", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Alpha]", "\[Element]", "Reals"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["nr", "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"abeW4th", "[", 
            RowBox[{"u", ",", "nr", ",", "\[Alpha]"}], "]"}], " ", ")"}], 
          "2"], "u"}], " ", ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "0", ",", 
          RowBox[{"1", "/", "nr"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "/", "\[Pi]"}]}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.891586885230776*^9, 3.8915868874932013`*^9}, {
   3.891587248482608*^9, 3.891587262314685*^9}, {3.891588090236438*^9, 
   3.891588095863696*^9}, {3.8915882774217043`*^9, 3.891588279315867*^9}, 
   3.8915884452960787`*^9, {3.89159191441186*^9, 3.8915919175727873`*^9}, 
   3.8916098286019917`*^9, {3.891665046428026*^9, 3.891665069094149*^9}, {
   3.891665112965384*^9, 3.891665115891824*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"994c56db-ceb1-430c-90e5-8a7e477a6aad"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"nr", ">", "1"}], ",", 
         RowBox[{"\[Alpha]", "\[Element]", "Reals"}]}], "}"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{"W2mean", "[", 
            RowBox[{"\[Alpha]", ",", "nr"}], "]"}], "-", 
           SuperscriptBox[
            RowBox[{"Wmean", "[", 
             RowBox[{"\[Alpha]", ",", "nr"}], "]"}], "2"]}], ")"}], ",", 
         "\[Alpha]"}], "]"}]}], "]"}], "\[Equal]", "0"}], ",", "\[Alpha]"}], 
   "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.891586890347822*^9, 3.891586890719388*^9}, {
  3.891665126488613*^9, 3.8916651568100233`*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"293c7c6d-2c1d-45d8-9054-93fd15597ae1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Alpha]", "\[Rule]", 
    FractionBox[
     RowBox[{
      SuperscriptBox["nr", "3"], " ", 
      RowBox[{"(", 
       RowBox[{"19", "+", 
        RowBox[{"75", " ", 
         SuperscriptBox["nr", "2"]}]}], ")"}]}], 
     RowBox[{"4", "+", 
      RowBox[{"30", " ", 
       SuperscriptBox["nr", "2"]}], "+", 
      RowBox[{"60", " ", 
       SuperscriptBox["nr", "4"]}]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.891586893224965*^9, 3.891586923406843*^9, 3.891587286566557*^9, 
   3.891588117056252*^9, 3.8915882875602407`*^9, 3.891588454496043*^9, 
   3.8916098461992607`*^9, {3.891665130932469*^9, 3.891665157891439*^9}, 
   3.891665207822391*^9},
 CellLabel->
  "Out[195]=",ExpressionUUID->"5b9aba51-b12b-46ad-a409-51b85385daeb"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"getW4min", "[", "nr_", "]"}], ":=", 
  FractionBox[
   RowBox[{
    SuperscriptBox["nr", "3"], " ", 
    RowBox[{"(", 
     RowBox[{"19", "+", 
      RowBox[{"75", " ", 
       SuperscriptBox["nr", "2"]}]}], ")"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", 
      RowBox[{"15", " ", 
       SuperscriptBox["nr", "2"]}], "+", 
      RowBox[{"30", " ", 
       SuperscriptBox["nr", "4"]}]}], ")"}]}]]}]], "Input",
 CellChangeTimes->{{3.89158759791214*^9, 3.891587606155809*^9}, 
   3.8915881512947683`*^9, 3.891588474479864*^9, 3.891609941864087*^9, {
   3.891665229041452*^9, 3.8916652336997957`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"54acec7e-2b97-4ab2-872f-f1ff48590824"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sixth order W rms", "Subsubsection",
 CellChangeTimes->{{3.8915256412649097`*^9, 3.891525649478364*^9}, {
  3.891665242933816*^9, 
  3.891665247730854*^9}},ExpressionUUID->"37b5d299-314e-4585-a1d3-\
aa7a6be58f39"],

Cell["\<\
Note that the nr multiplying the terms is there because the definition is \
with u running from 0 to 1 (the SA).\
\>", "Text",
 CellChangeTimes->{{3.891588045055072*^9, 3.891588080440371*^9}, 
   3.89158838461668*^9},ExpressionUUID->"fb2a9487-6401-47a2-9e40-\
b5f4fea6ecda"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Wmean", "[", 
    RowBox[{"\[Alpha]_", ",", "nr_"}], "]"}], "=", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nr", ">", "1"}], ",", 
       RowBox[{"\[Alpha]", "\[Element]", "Reals"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["nr", "2"], " ", 
         RowBox[{"abeW6th", "[", 
          RowBox[{"u", ",", "nr", ",", "\[Alpha]"}], "]"}], "u"}], ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "0", ",", 
          RowBox[{"1", "/", "nr"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "/", "\[Pi]"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"W2mean", "[", 
    RowBox[{"\[Alpha]_", ",", "nr_"}], "]"}], " ", "=", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Alpha]", "\[Element]", "Reals"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["nr", "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"abeW6th", "[", 
            RowBox[{"u", ",", "nr", ",", "\[Alpha]"}], "]"}], " ", ")"}], 
          "2"], "u"}], " ", ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "0", ",", 
          RowBox[{"1", "/", "nr"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "/", "\[Pi]"}]}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.891586885230776*^9, 3.8915868874932013`*^9}, {
   3.891587248482608*^9, 3.891587262314685*^9}, {3.891588090236438*^9, 
   3.891588095863696*^9}, {3.8915882774217043`*^9, 3.891588279315867*^9}, 
   3.8915884452960787`*^9, {3.89159191441186*^9, 3.8915919175727873`*^9}, 
   3.8916098286019917`*^9, {3.891665046428026*^9, 3.891665069094149*^9}, {
   3.891665112965384*^9, 3.891665115891824*^9}, {3.891665256982626*^9, 
   3.891665260429121*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"db495f1e-9eb7-4c1a-926a-8aba5a8f0cca"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"nr", ">", "1"}], ",", 
         RowBox[{"\[Alpha]", "\[Element]", "Reals"}]}], "}"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{"W2mean", "[", 
            RowBox[{"\[Alpha]", ",", "nr"}], "]"}], "-", 
           SuperscriptBox[
            RowBox[{"Wmean", "[", 
             RowBox[{"\[Alpha]", ",", "nr"}], "]"}], "2"]}], ")"}], ",", 
         "\[Alpha]"}], "]"}]}], "]"}], "\[Equal]", "0"}], ",", "\[Alpha]"}], 
   "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.891586890347822*^9, 3.891586890719388*^9}, {
  3.891665126488613*^9, 3.8916651568100233`*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"82617b78-4e31-4e40-a174-d8c839fa96f7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Alpha]", "\[Rule]", 
    FractionBox[
     RowBox[{
      SuperscriptBox["nr", "5"], " ", 
      RowBox[{"(", 
       RowBox[{"4269", "+", 
        RowBox[{"9352", " ", 
         SuperscriptBox["nr", "2"]}], "+", 
        RowBox[{"36624", " ", 
         SuperscriptBox["nr", "4"]}]}], ")"}]}], 
     RowBox[{"5", " ", 
      RowBox[{"(", 
       RowBox[{"81", "+", 
        RowBox[{"336", " ", 
         SuperscriptBox["nr", "2"]}], "+", 
        RowBox[{"1568", " ", 
         SuperscriptBox["nr", "4"]}], "+", 
        RowBox[{"2688", " ", 
         SuperscriptBox["nr", "6"]}], "+", 
        RowBox[{"5376", " ", 
         SuperscriptBox["nr", "8"]}]}], ")"}]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.891586893224965*^9, 3.891586923406843*^9, 3.891587286566557*^9, 
   3.891588117056252*^9, 3.8915882875602407`*^9, 3.891588454496043*^9, 
   3.8916098461992607`*^9, {3.891665130932469*^9, 3.891665157891439*^9}, 
   3.891665207822391*^9, 3.89166527872865*^9},
 CellLabel->
  "Out[199]=",ExpressionUUID->"4d1e9684-2a79-4e8a-b1f6-ee295f566231"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"getW6min", "[", "nr_", "]"}], ":=", 
  FractionBox[
   RowBox[{
    SuperscriptBox["nr", "5"], " ", 
    RowBox[{"(", 
     RowBox[{"4269", "+", 
      RowBox[{"9352", " ", 
       SuperscriptBox["nr", "2"]}], "+", 
      RowBox[{"36624", " ", 
       SuperscriptBox["nr", "4"]}]}], ")"}]}], 
   RowBox[{"5", " ", 
    RowBox[{"(", 
     RowBox[{"81", "+", 
      RowBox[{"336", " ", 
       SuperscriptBox["nr", "2"]}], "+", 
      RowBox[{"1568", " ", 
       SuperscriptBox["nr", "4"]}], "+", 
      RowBox[{"2688", " ", 
       SuperscriptBox["nr", "6"]}], "+", 
      RowBox[{"5376", " ", 
       SuperscriptBox["nr", "8"]}]}], ")"}]}]]}]], "Input",
 CellChangeTimes->{{3.89158759791214*^9, 3.891587606155809*^9}, 
   3.8915881512947683`*^9, 3.891588474479864*^9, 3.891609941864087*^9, {
   3.891665229041452*^9, 3.89166525179145*^9}, 3.891665285407243*^9},
 CellLabel->"In[5]:=",ExpressionUUID->"e6bc147d-1a10-454a-8120-84adedb69cf3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Whole W rms", "Subsubsection",
 CellChangeTimes->{{3.891525732979652*^9, 
  3.8915257402953672`*^9}},ExpressionUUID->"3e522d5a-85c7-41ac-8bd2-\
fa60fb856b6d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Wmean", "[", 
    RowBox[{"\[Alpha]_", ",", "nr_"}], "]"}], "=", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nr", ">", "1"}], ",", 
       RowBox[{"\[Alpha]", "\[Element]", "Reals"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["nr", "2"], " ", 
         RowBox[{"abeW", "[", 
          RowBox[{"u", ",", "nr", ",", "\[Alpha]"}], "]"}], "u"}], ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "0", ",", 
          RowBox[{"1", "/", "nr"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "/", "\[Pi]"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"W2mean", "[", 
    RowBox[{"\[Alpha]_", ",", "nr_"}], "]"}], " ", "=", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Alpha]", "\[Element]", "Reals"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["nr", "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"abeW", "[", 
            RowBox[{"u", ",", "nr", ",", "\[Alpha]"}], "]"}], ")"}], "2"], 
         "u"}], " ", ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "0", ",", 
          RowBox[{"1", "/", "nr"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "/", "\[Pi]"}]}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.891586885230776*^9, 3.8915868874932013`*^9}, {
   3.891587248482608*^9, 3.891587262314685*^9}, {3.891588090236438*^9, 
   3.891588095863696*^9}, {3.8915882774217043`*^9, 3.891588279315867*^9}, 
   3.8915884452960787`*^9, {3.89159191441186*^9, 3.8915919175727873`*^9}, 
   3.8916098286019917`*^9, {3.89161039787192*^9, 3.891610415278857*^9}, {
   3.8916660089149446`*^9, 3.89166601016931*^9}},
 CellLabel->
  "In[202]:=",ExpressionUUID->"afa24e15-5599-4999-ae48-a908441cd4c6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"nr", ">", "1"}], ",", 
         RowBox[{"\[Alpha]", "\[Element]", "Reals"}]}], "}"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{"W2mean", "[", 
            RowBox[{"\[Alpha]", ",", "nr"}], "]"}], "-", 
           SuperscriptBox[
            RowBox[{"Wmean", "[", 
             RowBox[{"\[Alpha]", ",", "nr"}], "]"}], "2"]}], ")"}], ",", 
         "\[Alpha]"}], "]"}]}], "]"}], "\[Equal]", "0"}], ",", "\[Alpha]"}], 
   "]"}], "//", "Simplify"}]], "Input",
 CellLabel->
  "In[204]:=",ExpressionUUID->"57e1a391-a61f-486d-add8-c822a794492e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Alpha]", "\[Rule]", 
    TemplateBox[{
      FractionBox[
       RowBox[{
         RowBox[{
           RowBox[{"-", "9"}], " ", "nr"}], "+", 
         RowBox[{"7", " ", 
           SuperscriptBox["nr", "3"]}], "+", 
         RowBox[{"16", " ", 
           SqrtBox[
            RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["nr", "2"]}]]}], "-", 
         RowBox[{"16", " ", 
           SuperscriptBox["nr", "2"], " ", 
           SqrtBox[
            RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["nr", "2"]}]]}], "+", 
         RowBox[{"9", " ", 
           SuperscriptBox[
            RowBox[{"(", 
              RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["nr", "2"]}], ")"}], "2"], " ", 
           RowBox[{"ArcCoth", "[", "nr", "]"}]}]}], 
       RowBox[{"2", "+", 
         RowBox[{"12", " ", 
           SuperscriptBox["nr", "2"]}], "-", 
         RowBox[{"48", " ", 
           SuperscriptBox["nr", "4"]}], "+", 
         RowBox[{"32", " ", 
           SuperscriptBox["nr", "6"]}], "+", 
         RowBox[{"32", " ", 
           SuperscriptBox["nr", "3"], " ", 
           SqrtBox[
            RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["nr", "2"]}]]}], "-", 
         RowBox[{"32", " ", 
           SuperscriptBox["nr", "5"], " ", 
           SqrtBox[
            RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["nr", "2"]}]]}]}]], 
      RowBox[{"nr", ">", "1"}]},
     "ConditionalExpression"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.8916660378079443`*^9},
 CellLabel->
  "Out[204]=",ExpressionUUID->"da0aa79a-c1f6-4183-88b2-293ad6002297"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"getWmin", "[", "nr_", "]"}], ":=", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", "9"}], " ", "nr"}], "+", 
    RowBox[{"7", " ", 
     SuperscriptBox["nr", "3"]}], "+", 
    RowBox[{"16", " ", 
     SqrtBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["nr", "2"]}]]}], "-", 
    RowBox[{"16", " ", 
     SuperscriptBox["nr", "2"], " ", 
     SqrtBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["nr", "2"]}]]}], "+", 
    RowBox[{"9", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["nr", "2"]}], ")"}], "2"], " ", 
     RowBox[{"ArcCoth", "[", "nr", "]"}]}]}], 
   RowBox[{"2", "+", 
    RowBox[{"12", " ", 
     SuperscriptBox["nr", "2"]}], "-", 
    RowBox[{"48", " ", 
     SuperscriptBox["nr", "4"]}], "+", 
    RowBox[{"32", " ", 
     SuperscriptBox["nr", "6"]}], "+", 
    RowBox[{"32", " ", 
     SuperscriptBox["nr", "3"], " ", 
     SqrtBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["nr", "2"]}]]}], "-", 
    RowBox[{"32", " ", 
     SuperscriptBox["nr", "5"], " ", 
     SqrtBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["nr", "2"]}]]}]}]]}]], "Input",
 CellChangeTimes->{
  3.891610697384433*^9, {3.8916107621232758`*^9, 3.891610775296753*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"6da59478-de27-411c-be10-ee9c7a46fe32"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Min spot size 4th order", "Subsubsection",
 CellChangeTimes->{{3.8915271916207933`*^9, 3.891527195366624*^9}, {
  3.891612003516464*^9, 
  3.89161200560927*^9}},ExpressionUUID->"6e662ed9-a15c-41fa-ab5b-\
924c06727112"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]x", "[", 
    RowBox[{"u_", ",", "\[Phi]_", ",", "\[Alpha]_", ",", "nr_"}], "]"}], "=", 
   
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"abeW4th", "[", 
          RowBox[{"u", ",", "nr", ",", "\[Alpha]"}], "]"}], "/.", 
         RowBox[{"u", "\[Rule]", 
          RowBox[{"(", 
           SqrtBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["ux", "2"], "+", 
              SuperscriptBox["uy", "2"]}], ")"}]], ")"}]}]}], ",", "ux"}], 
       "]"}], "/.", 
      RowBox[{"ux", "\[Rule]", 
       RowBox[{"u", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}]}], "/.", 
     RowBox[{"uy", "\[Rule]", 
      RowBox[{"u", " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]2mean", "[", 
    RowBox[{"\[Alpha]_", ",", "nr_"}], "]"}], " ", "=", " ", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nr", ">", "1"}], ",", 
       RowBox[{"\[Alpha]", "\[Element]", "Reals"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["nr", "2"], " ", 
         SuperscriptBox[
          RowBox[{"\[Epsilon]x", " ", "[", 
           RowBox[{"u", ",", "f", ",", "\[Alpha]", ",", "nr"}], "]"}], "2"], 
         "u"}], ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "0", ",", 
          RowBox[{"1", "/", "nr"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "/", "\[Pi]"}]}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.891611390798094*^9, 3.891611543574786*^9}, {
   3.891611604148979*^9, 3.89161163493124*^9}, 3.891611695009645*^9, {
   3.8916661075310297`*^9, 3.8916661216228037`*^9}, {3.891666266534336*^9, 
   3.8916662678948603`*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"31b9ccf5-4978-4b73-935c-fe8a067f3b18"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"nr", ">", "1"}], ",", 
         RowBox[{"\[Alpha]", "\[Element]", "Reals"}]}], "}"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Epsilon]2mean", "[", 
          RowBox[{"\[Alpha]", ",", "nr"}], "]"}], ",", "\[Alpha]"}], "]"}]}], 
      "]"}], "\[Equal]", "0"}], ",", "\[Alpha]"}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.8916663153852873`*^9, 3.891666326049119*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"f9909284-5920-4f40-aa95-deb81e529274"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Alpha]", "\[Rule]", 
    FractionBox[
     RowBox[{
      SuperscriptBox["nr", "3"], " ", 
      RowBox[{"(", 
       RowBox[{"11", "+", 
        RowBox[{"32", " ", 
         SuperscriptBox["nr", "2"]}]}], ")"}]}], 
     RowBox[{"3", "+", 
      RowBox[{"16", " ", 
       SuperscriptBox["nr", "2"]}], "+", 
      RowBox[{"24", " ", 
       SuperscriptBox["nr", "4"]}]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.891611386929915*^9, 3.8916114248032*^9, 3.8916114694707117`*^9, {
   3.891611523977584*^9, 3.89161154400511*^9}, 3.891611635497232*^9, 
   3.89161170532585*^9, 3.891666364215625*^9},
 CellLabel->
  "Out[207]=",ExpressionUUID->"89b0442e-5024-46cd-b15a-b36bff679e5e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"get\[Epsilon]4min", "[", "nr_", "]"}], ":=", 
  FractionBox[
   RowBox[{
    SuperscriptBox["nr", "3"], " ", 
    RowBox[{"(", 
     RowBox[{"11", "+", 
      RowBox[{"32", " ", 
       SuperscriptBox["nr", "2"]}]}], ")"}]}], 
   RowBox[{"3", "+", 
    RowBox[{"16", " ", 
     SuperscriptBox["nr", "2"]}], "+", 
    RowBox[{"24", " ", 
     SuperscriptBox["nr", "4"]}]}]]}]], "Input",
 CellChangeTimes->{{3.891611867625679*^9, 3.891611892533559*^9}, 
   3.8916119430612926`*^9, {3.891666141463709*^9, 3.891666146213204*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"c76a3a6d-52d9-45ee-963d-099d024e50d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Min spot size 6th", "Subsubsection",
 CellChangeTimes->{{3.8915271916207933`*^9, 3.891527195366624*^9}, {
  3.891612003516464*^9, 3.891612016884411*^9}, {3.891664516695654*^9, 
  3.89166451722122*^9}},ExpressionUUID->"35d66903-84b7-4229-9b1d-\
13f705402a03"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]x", "[", 
    RowBox[{"u_", ",", "\[Phi]_", ",", "\[Alpha]_", ",", "nr_"}], "]"}], "=", 
   
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"abeW6th", "[", 
          RowBox[{"u", ",", "nr", ",", "\[Alpha]"}], "]"}], "/.", 
         RowBox[{"u", "\[Rule]", 
          RowBox[{"(", 
           SqrtBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["ux", "2"], "+", 
              SuperscriptBox["uy", "2"]}], ")"}]], ")"}]}]}], ",", "ux"}], 
       "]"}], "/.", 
      RowBox[{"ux", "\[Rule]", 
       RowBox[{"u", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}]}], "/.", 
     RowBox[{"uy", "\[Rule]", 
      RowBox[{"u", " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]2mean", "[", 
    RowBox[{"\[Alpha]_", ",", "nr_"}], "]"}], " ", "=", " ", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nr", ">", "1"}], ",", 
       RowBox[{"\[Alpha]", "\[Element]", "Reals"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["nr", "2"], " ", 
         SuperscriptBox[
          RowBox[{"\[Epsilon]x", " ", "[", 
           RowBox[{"u", ",", "f", ",", "\[Alpha]", ",", "nr"}], "]"}], "2"], 
         "u"}], ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "0", ",", 
          RowBox[{"1", "/", "nr"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "/", "\[Pi]"}]}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.891611390798094*^9, 3.891611543574786*^9}, {
   3.891611604148979*^9, 3.89161163493124*^9}, 3.891611695009645*^9, {
   3.8916661075310297`*^9, 3.8916661216228037`*^9}, {3.891666266534336*^9, 
   3.8916662678948603`*^9}, 3.89166640282023*^9},
 CellLabel->
  "In[208]:=",ExpressionUUID->"d9d05580-2c2c-42b7-b948-5178c5d821bf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"nr", ">", "1"}], ",", 
         RowBox[{"\[Alpha]", "\[Element]", "Reals"}]}], "}"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Epsilon]2mean", "[", 
          RowBox[{"\[Alpha]", ",", "nr"}], "]"}], ",", "\[Alpha]"}], "]"}]}], 
      "]"}], "\[Equal]", "0"}], ",", "\[Alpha]"}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellLabel->
  "In[210]:=",ExpressionUUID->"fcf2239e-66f2-41b2-a068-326f23d59bba"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Alpha]", "\[Rule]", 
    FractionBox[
     RowBox[{
      SuperscriptBox["nr", "5"], " ", 
      RowBox[{"(", 
       RowBox[{"297", "+", 
        RowBox[{"512", " ", 
         SuperscriptBox["nr", "2"]}], "+", 
        RowBox[{"1460", " ", 
         SuperscriptBox["nr", "4"]}]}], ")"}]}], 
     RowBox[{"45", "+", 
      RowBox[{"144", " ", 
       SuperscriptBox["nr", "2"]}], "+", 
      RowBox[{"480", " ", 
       SuperscriptBox["nr", "4"]}], "+", 
      RowBox[{"640", " ", 
       SuperscriptBox["nr", "6"]}], "+", 
      RowBox[{"960", " ", 
       SuperscriptBox["nr", "8"]}]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.891666422151457*^9},
 CellLabel->
  "Out[210]=",ExpressionUUID->"4b7dad52-7989-422d-982e-35bbdb87fa05"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"get\[Epsilon]6min", "[", "nr_", "]"}], ":=", 
  FractionBox[
   RowBox[{
    SuperscriptBox["nr", "5"], " ", 
    RowBox[{"(", 
     RowBox[{"297", "+", 
      RowBox[{"512", " ", 
       SuperscriptBox["nr", "2"]}], "+", 
      RowBox[{"1460", " ", 
       SuperscriptBox["nr", "4"]}]}], ")"}]}], 
   RowBox[{"45", "+", 
    RowBox[{"144", " ", 
     SuperscriptBox["nr", "2"]}], "+", 
    RowBox[{"480", " ", 
     SuperscriptBox["nr", "4"]}], "+", 
    RowBox[{"640", " ", 
     SuperscriptBox["nr", "6"]}], "+", 
    RowBox[{"960", " ", 
     SuperscriptBox["nr", "8"]}]}]]}]], "Input",
 CellChangeTimes->{{3.891611867625679*^9, 3.891611892533559*^9}, 
   3.8916119430612926`*^9, {3.891612367331818*^9, 3.8916123893860273`*^9}, 
   3.891612508753971*^9, 3.8916647503301497`*^9, 3.891666160216291*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"4cb4401c-2774-48ae-96e0-2e2f7d40869d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Confusion", "Subsubsection",
 CellChangeTimes->{{3.89161269058197*^9, 
  3.891612692529151*^9}},ExpressionUUID->"1c7fc80f-639e-4ad9-abfc-\
8cd4176b12a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getLeastConfusion", "[", 
   RowBox[{"smax_", ",", "nr_"}], "]"}], ":=", 
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{"x", "/.", 
     RowBox[{
      RowBox[{"NSolve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                FractionBox[
                 RowBox[{" ", "smax"}], 
                 RowBox[{
                  SqrtBox[
                   RowBox[{"1", "-", 
                    SuperscriptBox["smax", "2"]}]], " "}]], "+", 
                FractionBox[
                 RowBox[{"smax", " ", "x"}], 
                 RowBox[{"nr", " ", 
                  SqrtBox[
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox["smax", "2"], " "}], 
                    SuperscriptBox["nr", "2"]]}]]}]]}], ")"}], 
              SqrtBox[
               RowBox[{"1", "-", 
                SuperscriptBox[
                 RowBox[{"(", 
                  FractionBox["1", "nr"], ")"}], "2"]}]]}], ")"}], 
            RowBox[{"2", "/", "3"}]]}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", 
             FractionBox["x", "nr"]}], ")"}], 
           RowBox[{"2", "/", "3"}]]}], "\[Equal]", "1"}], ",", "x"}], "]"}], 
      "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.89166772725219*^9, 3.891667802534791*^9}, {
  3.891667841695862*^9, 3.891667982652577*^9}, {3.8916680781932983`*^9, 
  3.891668105085793*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"14562c5e-b1f5-427c-b07c-11cc23df7da8"],

Cell["\<\
\[Theta] is the angle of the ray emerging from the source, x the position \
with the zero at the interface\
\>", "Text",
 CellChangeTimes->{{3.891667534220386*^9, 
  3.8916675658512497`*^9}},ExpressionUUID->"5b25d158-ee6d-4638-8de0-\
5b3651053232"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "[", 
   RowBox[{"\[Theta]_", ",", "ni_", ",", "nf_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{"ni", " ", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], "/", "nf"}]}], 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"ni", " ", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "/", "nf"}]}], ")"}], 
      "2"]}]]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "[", 
   RowBox[{"\[Theta]_", ",", "ni_", ",", "nf_", ",", "d_"}], "]"}], ":=", 
  RowBox[{"d", " ", 
   RowBox[{"Tan", "[", "\[Theta]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "[", 
   RowBox[{"\[Phi]_", ",", "\[Theta]_", ",", "ni_", ",", "nf_", ",", "d_"}], 
   "]"}], ":=", 
  FractionBox[
   RowBox[{"b", "[", 
    RowBox[{"\[Theta]", ",", "ni", ",", "nf", ",", "d"}], "]"}], 
   RowBox[{
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "-", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\[Theta]", ",", "ni", ",", "nf"}], "]"}], 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "[", 
   RowBox[{"x_", ",", "\[Theta]_", ",", "ni_", ",", "nf_", ",", "d_"}], "]"}],
   ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"\[Theta]", ",", "ni", ",", "nf"}], "]"}], "x"}], "+", 
   RowBox[{"b", "[", 
    RowBox[{"\[Theta]", ",", "ni", ",", "nf", ",", "d"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.891612709279779*^9, 3.891612713848607*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"b142235b-8962-495a-a165-532e034c2a47"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Comparisson", "Subsection",
 CellChangeTimes->{
  3.8916118650404654`*^9, {3.891611957898706*^9, 
   3.8916119597327538`*^9}},ExpressionUUID->"e4442799-526a-4e22-a5c1-\
742ba2eafc46"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"nr", " ", "=", " ", 
     RowBox[{"1.515", "/", "1.33"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"getParaxial", "[", "nr", "]"}], ",", 
     RowBox[{"getW4min", "[", "nr", "]"}], ",", 
     RowBox[{"getW6min", "[", "nr", "]"}], ",", 
     RowBox[{"getWmin", "[", "nr", "]"}], ",", 
     RowBox[{"get\[Epsilon]4min", "[", "nr", "]"}], ",", 
     RowBox[{"get\[Epsilon]6min", "[", "nr", "]"}], ",", 
     RowBox[{"getLeastConfusion", "[", 
      RowBox[{
       RowBox[{"1", "/", "nr"}], ",", "nr"}], "]"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.891587533098774*^9, 3.89158759057756*^9}, {
   3.891587906743524*^9, 3.891587912316362*^9}, {3.891588628322069*^9, 
   3.8915886316460447`*^9}, 3.891610045109064*^9, {3.891610704879797*^9, 
   3.891610711044248*^9}, {3.891611901522427*^9, 3.8916119036161623`*^9}, {
   3.8916123989837837`*^9, 3.8916124018598833`*^9}, {3.891665296475322*^9, 
   3.891665308353525*^9}, {3.891666482383236*^9, 3.891666498105629*^9}, {
   3.891668095315209*^9, 3.8916681400051003`*^9}, 3.8916742531688423`*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"7afc98e7-8467-4cd9-8c95-1c11c819cd8a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.139097744360902`", ",", "1.1943444145193585`", ",", "1.233843812855304`",
    ",", "1.395024655268398`", ",", "1.209772380069772`", ",", 
   "1.2710641779602763`", ",", "1.4116668835501691`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.891587624260508*^9, {3.891588157217502*^9, 3.891588161067061*^9}, 
   3.8915886325434723`*^9, 3.891610053555846*^9, 3.891610711821129*^9, 
   3.891610782768936*^9, 3.891611904304574*^9, 3.8916119475940437`*^9, 
   3.891612402417481*^9, 3.8916647628869677`*^9, 3.891665320494257*^9, {
   3.891666488489964*^9, 3.891666498849547*^9}, 3.891668142423064*^9, 
   3.8916742558701787`*^9, 3.8916743102288637`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"b4b9220c-3f1f-47e5-a95b-51fb927c9a05"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotRaysInterface", "[", 
   RowBox[{"ni_", ",", "nf_", ",", "na_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dcs", "=", "50"}], ",", 
      RowBox[{"num\[Theta]", "=", "25"}], ",", 
      RowBox[{"\[Alpha]", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nr", ",", 
        RowBox[{"pry", "=", 
         RowBox[{"0.5", "*", "dcs"}]}], ",", "\[Theta]imax", ",", 
        "\[Theta]ilist", ",", "\[Theta]flist", ",", "\[Alpha]par", ",", 
        "\[Alpha]\[Epsilon]list", ",", "prxm", ",", "prxp", ",", "\[Alpha]lc",
         ",", "\[Alpha]Wlist"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nr", " ", "=", " ", 
        RowBox[{"nf", "/", "ni"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"prxm", "=", 
        RowBox[{
         RowBox[{"-", "2.5"}], "dcs"}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{".1", "+", "\[Alpha]"}], ")"}], "nf", " ", 
         RowBox[{"dcs", "/", "ni"}]}], "*)"}], ";", "\[IndentingNewLine]", 
       RowBox[{"prxp", "=", 
        RowBox[{"0.1", "nf", " ", 
         RowBox[{"dcs", "/", "ni"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Theta]imax", "=", 
        RowBox[{"ArcSin", "[", 
         RowBox[{"na", "/", "nf"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Theta]ilist", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"\[Theta]", ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", 
              RowBox[{"-", "\[Theta]imax"}], ",", 
              RowBox[{
               RowBox[{"-", "\[Theta]imax"}], "/", "num\[Theta]"}], ",", 
              RowBox[{"\[Theta]imax", "/", "num\[Theta]"}]}], "}"}]}], "]"}], 
          ",", 
          RowBox[{"Table", "[", 
           RowBox[{"\[Theta]", ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", 
              RowBox[{"\[Theta]imax", "/", "num\[Theta]"}], ",", 
              "\[Theta]imax", ",", 
              RowBox[{"\[Theta]imax", "/", "num\[Theta]"}]}], "}"}]}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Theta]flist", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArcSin", "[", 
           RowBox[{
            FractionBox["ni", "nf"], 
            RowBox[{"Sin", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
         "\[Theta]ilist"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Alpha]lc", " ", "=", 
        RowBox[{"getLeastConfusion", "[", 
         RowBox[{
          RowBox[{"1", "/", "nr"}], ",", "nr"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Alpha]par", "=", 
        RowBox[{"getParaxial", "[", "nr", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Alpha]Wlist", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"getW4min", "[", "nr", "]"}], ",", 
          RowBox[{"getW6min", "[", "nr", "]"}], ",", 
          RowBox[{"getWmin", "[", "nr", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Alpha]\[Epsilon]list", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"get\[Epsilon]4min", "[", "nr", "]"}], ",", 
          RowBox[{"get\[Epsilon]6min", "[", "nr", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Graphics", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Thick", ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "pry"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "pry"}], "}"}]}], "}"}], "]"}]}], "}"}],
                 ",", "\[IndentingNewLine]", "Dotted", ",", 
                RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "dcs"}], ",", 
                    RowBox[{"-", "pry"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "dcs"}], ",", "pry"}], "}"}]}], "}"}], "]"}],
                 ",", "\[IndentingNewLine]", "DotDashed", ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[Alpha]par"}], " ", "dcs"}], ",", 
                    RowBox[{"-", "pry"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[Alpha]par"}], " ", "dcs"}], ",", "pry"}], 
                    "}"}]}], "}"}], "]"}], ",", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[Alpha]derW"}], " ", "dcs"}], ",", 
                    RowBox[{"-", "pry"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[Alpha]derW"}], " ", "dcs"}], ",", "pry"}],
                     "}"}]}], "}"}], "]"}], ","}], "*)"}], 
                "\[IndentingNewLine]", "Dashed", ",", "Magenta", ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[Alpha]lc"}], " ", "dcs"}], ",", 
                    RowBox[{"-", "pry"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[Alpha]lc"}], " ", "dcs"}], ",", "pry"}], 
                    "}"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Darker", "[", 
                    RowBox[{
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.", ",", "0.69", ",", "1."}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "/", "4"}]}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Alpha]Wlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "dcs"}], ",", 
                    RowBox[{"-", "pry"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Alpha]Wlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], " ", "dcs"}], ",", 
                    "pry"}], "}"}]}], "}"}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Darker", "[", 
                    RowBox[{
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.9", ",", "0.54", ",", "0."}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "/", "4"}]}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Alpha]\[Epsilon]list", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "dcs"}], ",", 
                    RowBox[{"-", "pry"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Alpha]\[Epsilon]list", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], " ", "dcs"}], ",", 
                    "pry"}], "}"}]}], "}"}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}]}], "}"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Source", " ", "rays"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"Blue", ",", "Thin", ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "dcs"}], ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "dcs"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"dcs", " ", 
                    RowBox[{"Tan", "[", "#", "]"}]}]}], "}"}]}], "}"}], "]"}],
                   "&"}], "/@", "\[Theta]ilist"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Refracted", " ", "rays"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Hue", "[", 
                 RowBox[{"0.88", ",", "1.", ",", "0.65"}], "]"}], ",", " ", 
                "Thin", ",", " ", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"prxm", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"prxp", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"prxm", ",", 
                    RowBox[{"y", "[", 
                    RowBox[{
                    "prxm", ",", "#", ",", "ni", ",", "nf", ",", "dcs"}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"prxp", ",", 
                    RowBox[{"y", "[", 
                    RowBox[{
                    "prxp", ",", "#", ",", "ni", ",", "nf", ",", "dcs"}], 
                    "]"}]}], "}"}]}], "}"}], "]"}], "&"}], "/@", 
                 "\[Theta]ilist"}]}], "}"}]}], "}"}], "\[IndentingNewLine]", 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", "Caustic", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"ParametricPlot", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                FractionBox[
                 RowBox[{
                  RowBox[{"-", "dcs"}], " ", "nf"}], "ni"], 
                SuperscriptBox[
                 RowBox[{"Cosh", "[", "\[Theta]", "]"}], "3"]}], ",", 
               RowBox[{
                FractionBox[
                 RowBox[{"dcs", " ", "nf"}], 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox["nf", "2"], "-", 
                   SuperscriptBox["ni", "2"]}]]], 
                SuperscriptBox[
                 RowBox[{"Sinh", "[", "\[Theta]", "]"}], "3"]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]", ",", 
               RowBox[{
                RowBox[{"-", "\[Pi]"}], "/", "2"}], ",", 
               RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"Red", ",", "Thick"}], "}"}]}]}], "]"}]}], "}"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"prxm", ",", "prxp"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "pry"}], ",", "pry"}], "}"}]}], "}"}]}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8916127677470217`*^9, 3.8916128654088306`*^9}, {
   3.8916129406052713`*^9, 3.8916130114715567`*^9}, {3.891667096848308*^9, 
   3.891667102199148*^9}, {3.891667149561604*^9, 3.891667171310954*^9}, {
   3.891667210085889*^9, 3.891667218766089*^9}, {3.891668415354864*^9, 
   3.8916684607157383`*^9}, {3.8916687507835913`*^9, 3.891668786571886*^9}, {
   3.8916688593141003`*^9, 3.8916690596643667`*^9}, 3.891669109029443*^9, {
   3.891669155375828*^9, 3.891669156354622*^9}, {3.891669187741592*^9, 
   3.8916691960470324`*^9}, {3.89166923510981*^9, 3.891669250456623*^9}, {
   3.8916693011979923`*^9, 3.891669303014583*^9}, {3.8916693437956867`*^9, 
   3.891669438153973*^9}, {3.8916694907391577`*^9, 3.8916696637292767`*^9}, {
   3.891669829520404*^9, 3.891669855932665*^9}, 3.891674250523918*^9, {
   3.8916809675659213`*^9, 3.891681009155408*^9}, {3.8916810481550584`*^9, 
   3.8916810732540445`*^9}, 3.891681117594802*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"89d5599d-cd68-427b-891b-fa0f52a3a4f6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"savePath", " ", "=", " ", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<figures\>\"", ",", 
     "\"\<best_focus\>\""}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8916813281826134`*^9, 3.891681332536542*^9}, {
  3.891681374500672*^9, 3.8916813795727844`*^9}, {3.8916814718944387`*^9, 
  3.891681511885998*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"cf9ade2b-92f7-4145-8a4c-f48c75d920ab"],

Cell[BoxData["\<\"C:\\\\Users\\\\Rodrigo.SAOPAULO\\\\Documents\\\\Research\\\\\
pyPSFstack\\\\figures\\\\best_focus\"\>"], "Output",
 CellChangeTimes->{
  3.8916813329427805`*^9, 3.8916813807740135`*^9, {3.8916815003671365`*^9, 
   3.8916815125175467`*^9}},
 CellLabel->"Out[27]=",ExpressionUUID->"55b7517b-027b-4cbd-873e-5f0d89bf6f3a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"plotRaysInterface", "[", 
  RowBox[{"1.33", ",", "1.515", ",", "1.33"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"savePath", " ", ",", "\"\<IntWaterOil.pdf\>\""}], "}"}], "]"}], 
   ",", "%"}], "]"}]}], "Input",
 CellChangeTimes->{{3.891681097279011*^9, 3.8916811109603014`*^9}, {
  3.8916812014265304`*^9, 3.891681249717989*^9}, {3.8916815232789555`*^9, 
  3.8916815377220745`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"5ba6ca9b-1cc6-4c9a-b10d-8dc8dec51970"],

Cell[BoxData[
 GraphicsBox[{{{
     {Thickness[Large], LineBox[{{0, -25.}, {0, 25.}}]}, 
     {AbsoluteThickness[1], Dashing[{0, Small}], 
      LineBox[{{-50, -25.}, {-50, 25.}}], 
      {Dashing[{0, Small, Small, Small}], 
       LineBox[{{-56.9548872180451, -25.}, {-56.9548872180451, 25.}}]}, 
      {RGBColor[1, 0, 1], Dashing[{Small, Small}], 
       LineBox[{{-70.58334417750845, -25.}, {-70.58334417750845, 25.}}], {
        {RGBColor[0., 0.69, 1.], 
         LineBox[{{-59.71722072596792, -25.}, {-59.71722072596792, 25.}}]}, 
        {RGBColor[0., 0.5175, 0.75], 
         LineBox[{{-61.6921906427652, -25.}, {-61.6921906427652, 25.}}]}, 
        {RGBColor[0., 0.345, 0.5], 
         LineBox[{{-69.7512327634199, -25.}, {-69.7512327634199, 25.}}]}}, {
        {RGBColor[0.9, 0.54, 0.], 
         LineBox[{{-60.488619003488594`, -25.}, {-60.488619003488594`, 
          25.}}]}, 
        {RGBColor[0.675, 0.405, 0.], 
         LineBox[{{-63.553208898013814`, -25.}, {-63.553208898013814`, 
          25.}}]}}}}}, 
    {RGBColor[0, 0, 1], Thickness[Tiny], 
     LineBox[{{-50, 0}, {0, 0}}], {
      LineBox[{{-50, 0}, {0, -91.66312215259012}}], 
      LineBox[{{-50, 0}, {0, -82.9941976486229}}], 
      LineBox[{{-50, 0}, {0, -75.47740165901845}}], 
      LineBox[{{-50, 0}, {0, -68.87463344163523}}], 
      LineBox[{{-50, 0}, {0, -63.00843024082998}}], 
      LineBox[{{-50, 0}, {0, -57.74374637872408}}], 
      LineBox[{{-50, 0}, {0, -52.9759242422845}}], 
      LineBox[{{-50, 0}, {0, -48.622533176340376`}}], 
      LineBox[{{-50, 0}, {0, -44.61769833629348}}], 
      LineBox[{{-50, 0}, {0, -40.90807530956355}}], 
      LineBox[{{-50, 0}, {0, -37.44993819899984}}], 
      LineBox[{{-50, 0}, {0, -34.20703682246287}}], 
      LineBox[{{-50, 0}, {0, -31.14899511445037}}], 
      LineBox[{{-50, 0}, {0, -28.25009673270434}}], 
      LineBox[{{-50, 0}, {0, -25.488351847524804`}}], 
      LineBox[{{-50, 0}, {0, -22.844770856120384`}}], 
      LineBox[{{-50, 0}, {0, -20.302792178972275`}}], 
      LineBox[{{-50, 0}, {0, -17.847825969754055`}}], 
      LineBox[{{-50, 0}, {0, -15.466885774950633`}}], 
      LineBox[{{-50, 0}, {0, -13.14828736865411}}], 
      LineBox[{{-50, 0}, {0, -10.881399110304338`}}], 
      LineBox[{{-50, 0}, {0, -8.656431856006641}}], 
      LineBox[{{-50, 0}, {0, -6.464259118499588}}], 
      LineBox[{{-50, 0}, {0, -4.296260102355464}}], 
      LineBox[{{-50, 0}, {0, -2.144179634595676}}], 
      LineBox[{{-50, 0}, {0, 2.144179634595673}}], 
      LineBox[{{-50, 0}, {0, 4.2962601023554585`}}], 
      LineBox[{{-50, 0}, {0, 6.4642591184995855`}}], 
      LineBox[{{-50, 0}, {0, 8.656431856006641}}], 
      LineBox[{{-50, 0}, {0, 10.881399110304333`}}], 
      LineBox[{{-50, 0}, {0, 13.148287368654104`}}], 
      LineBox[{{-50, 0}, {0, 15.466885774950631`}}], 
      LineBox[{{-50, 0}, {0, 17.847825969754055`}}], 
      LineBox[{{-50, 0}, {0, 20.302792178972272`}}], 
      LineBox[{{-50, 0}, {0, 22.844770856120377`}}], 
      LineBox[{{-50, 0}, {0, 25.488351847524797`}}], 
      LineBox[{{-50, 0}, {0, 28.25009673270434}}], 
      LineBox[{{-50, 0}, {0, 31.14899511445037}}], 
      LineBox[{{-50, 0}, {0, 34.20703682246287}}], 
      LineBox[{{-50, 0}, {0, 37.449938198999824`}}], 
      LineBox[{{-50, 0}, {0, 40.90807530956355}}], 
      LineBox[{{-50, 0}, {0, 44.61769833629348}}], 
      LineBox[{{-50, 0}, {0, 48.622533176340376`}}], 
      LineBox[{{-50, 0}, {0, 52.97592424228448}}], 
      LineBox[{{-50, 0}, {0, 57.74374637872408}}], 
      LineBox[{{-50, 0}, {0, 63.00843024082998}}], 
      LineBox[{{-50, 0}, {0, 68.87463344163523}}], 
      LineBox[{{-50, 0}, {0, 75.47740165901844}}], 
      LineBox[{{-50, 0}, {0, 82.9941976486229}}], 
      LineBox[{{-50, 0}, {0, 91.66312215259012}}]}}, 
    {Hue[0.88, 1., 0.65], Thickness[Tiny], 
     LineBox[{{-125., 0}, {5.6954887218045105`, 0}}], {
      LineBox[{{-125., 59.51981095377835}, {
       5.6954887218045105`, -98.5516076760833}}], 
      LineBox[{{-125., 59.59689582326439}, {
       5.6954887218045105`, -89.49120536621416}}], 
      LineBox[{{-125., 58.77160350227501}, {
       5.6954887218045105`, -81.59431121749543}}], 
      LineBox[{{-125., 57.30651319575499}, {
       5.6954887218045105`, -74.62393982225616}}], 
      LineBox[{{-125., 55.38997377614645}, {
       5.6954887218045105`, -68.40312443889673}}], 
      LineBox[{{-125., 53.15802431953905}, {
       5.6954887218045105`, -62.79686465264494}}], 
      LineBox[{{-125., 50.70933469593471}, {
       5.6954887218045105`, -57.70023002548456}}], 
      LineBox[{{-125., 48.1155944694301}, {
       5.6954887218045105`, -53.03030049614014}}], 
      LineBox[{{-125., 45.42884925687745}, {
       5.6954887218045105`, -48.72057110632819}}], 
      LineBox[{{-125., 42.686744899170684`}, {
       5.6954887218045105`, -44.71698215516452}}], 
      LineBox[{{-125., 39.91631304574239}, {
       5.6954887218045105`, -40.97504709030163}}], 
      LineBox[{{-125., 37.136726017285284`}, {
       5.6954887218045105`, -37.45773759546192}}], 
      LineBox[{{-125., 34.3613152473914}, {
       5.6954887218045105`, -34.133900985072636`}}], 
      LineBox[{{-125., 31.59905873746995}, {
       5.6954887218045105`, -30.977058252623557`}}], 
      LineBox[{{-125., 28.855682662307935`}, {
       5.6954887218045105`, -27.964478532709663`}}], 
      LineBox[{{-125., 26.13448070349086}, {
       5.6954887218045105`, -25.076457055001917`}}], 
      LineBox[{{-125., 23.436925674984586`}, {
       5.6954887218045105`, -22.295744736829256`}}], 
      LineBox[{{-125., 20.763127538042028`}, {
       5.6954887218045105`, -19.607091971688224`}}], 
      LineBox[{{-125., 18.112177337661592`}, {
       5.6954887218045105`, -16.99687917692379}}], 
      LineBox[{{-125., 15.482406152715392`}, {
       5.6954887218045105`, -14.452813705041322`}}], 
      LineBox[{{-125., 12.871580624611964`}, {
       5.6954887218045105`, -11.963677735820074`}}], 
      LineBox[{{-125., 10.277051179206815`}, {
       5.6954887218045105`, -9.519115368738923}}], 
      LineBox[{{-125., 7.695865102307319}, {
       5.6954887218045105`, -7.109449740891241}}], 
      LineBox[{{-125., 5.124853763823663}, {
       5.6954887218045105`, -4.725522884528738}}], 
      LineBox[{{-125., 2.5607012242064027`}, {
       5.6954887218045105`, -2.358552401545605}}], 
      LineBox[{{-125., -2.5607012242064}, {5.6954887218045105`, 
       2.358552401545602}}], 
      LineBox[{{-125., -5.124853763823656}, {5.6954887218045105`, 
       4.725522884528733}}], 
      LineBox[{{-125., -7.695865102307316}, {5.6954887218045105`, 
       7.109449740891238}}], 
      LineBox[{{-125., -10.277051179206815`}, {5.6954887218045105`, 
       9.519115368738923}}], 
      LineBox[{{-125., -12.871580624611962`}, {5.6954887218045105`, 
       11.963677735820067`}}], 
      LineBox[{{-125., -15.482406152715386`}, {5.6954887218045105`, 
       14.452813705041315`}}], 
      LineBox[{{-125., -18.112177337661592`}, {5.6954887218045105`, 
       16.99687917692379}}], 
      LineBox[{{-125., -20.763127538042028`}, {5.6954887218045105`, 
       19.607091971688224`}}], 
      LineBox[{{-125., -23.43692567498459}, {5.6954887218045105`, 
       22.295744736829253`}}], 
      LineBox[{{-125., -26.13448070349083}, {5.6954887218045105`, 
       25.07645705500191}}], 
      LineBox[{{-125., -28.855682662307927`}, {5.6954887218045105`, 
       27.964478532709656`}}], 
      LineBox[{{-125., -31.59905873746995}, {5.6954887218045105`, 
       30.977058252623557`}}], 
      LineBox[{{-125., -34.3613152473914}, {5.6954887218045105`, 
       34.133900985072636`}}], 
      LineBox[{{-125., -37.136726017285284`}, {5.6954887218045105`, 
       37.45773759546192}}], 
      LineBox[{{-125., -39.91631304574238}, {5.6954887218045105`, 
       40.97504709030161}}], 
      LineBox[{{-125., -42.686744899170684`}, {5.6954887218045105`, 
       44.71698215516452}}], 
      LineBox[{{-125., -45.42884925687745}, {5.6954887218045105`, 
       48.72057110632819}}], 
      LineBox[{{-125., -48.1155944694301}, {5.6954887218045105`, 
       53.03030049614014}}], 
      LineBox[{{-125., -50.70933469593473}, {5.6954887218045105`, 
       57.700230025484544`}}], 
      LineBox[{{-125., -53.15802431953905}, {5.6954887218045105`, 
       62.79686465264494}}], 
      LineBox[{{-125., -55.38997377614645}, {5.6954887218045105`, 
       68.40312443889673}}], 
      LineBox[{{-125., -57.30651319575499}, {5.6954887218045105`, 
       74.62393982225616}}], 
      LineBox[{{-125., -58.77160350227503}, {5.6954887218045105`, 
       81.59431121749542}}], 
      LineBox[{{-125., -59.59689582326439}, {5.6954887218045105`, 
       89.49120536621416}}], 
      LineBox[{{-125., -59.51981095377835}, {5.6954887218045105`, 
       98.5516076760833}}]}}}, {{{}, {}, 
     TagBox[
      {RGBColor[1, 0, 0], Thickness[Large], Opacity[1.], FaceForm[Opacity[
       0.3]], LineBox[CompressedData["
1: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
4+BtBaQatSXj/+//H/8fycEgeQ==
        "]]},
      Annotation[#, "Charting`Private`Tag$21430#1"]& ]}, {}}},
  PlotRange->{{-125., 5.6954887218045105`}, {-25., 25.}}]], "Output",
 CellChangeTimes->{3.891680848377039*^9, 3.891680973902427*^9, 
  3.891681011910595*^9, 3.8916811243244123`*^9, 3.8916812508543987`*^9, 
  3.8916815399445333`*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"a9a0fab4-157b-4bcd-8454-92110ece9abb"],

Cell[BoxData["\<\"C:\\\\Users\\\\Rodrigo.SAOPAULO\\\\Documents\\\\Research\\\\\
pyPSFstack\\\\figures\\\\best_focus\\\\IntWaterOil.pdf\"\>"], "Output",
 CellChangeTimes->{3.891680848377039*^9, 3.891680973902427*^9, 
  3.891681011910595*^9, 3.8916811243244123`*^9, 3.8916812508543987`*^9, 
  3.891681540383711*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"80f6f714-cfa4-4b6d-aefc-fc8bd1687516"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"nr", " ", "=", " ", 
     RowBox[{"1.515", "/", "1.33"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"getParaxial", "[", "nr", "]"}], ",", 
     RowBox[{"getW4min", "[", "nr", "]"}], ",", 
     RowBox[{"getW6min", "[", "nr", "]"}], ",", 
     RowBox[{"getWmin", "[", "nr", "]"}], ",", 
     RowBox[{"get\[Epsilon]4min", "[", "nr", "]"}], ",", 
     RowBox[{"get\[Epsilon]6min", "[", "nr", "]"}], ",", 
     RowBox[{"getLeastConfusion", "[", 
      RowBox[{
       RowBox[{"1", "/", "nr"}], ",", "nr"}], "]"}]}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"56f97bdd-d924-4d11-acd9-757238c1ab38"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"plotRaysInterface", "[", 
  RowBox[{"1.", ",", "1.515", ",", "1."}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"savePath", " ", ",", "\"\<IntAirOil.pdf\>\""}], "}"}], "]"}], 
   ",", "%"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8916811678262672`*^9, 3.8916811709447627`*^9}, {
  3.8916815479912148`*^9, 3.891681554532051*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"1311847e-f1a2-4cb4-8c96-4559d0d3d1e4"],

Cell[BoxData[
 GraphicsBox[{{{
     {Thickness[Large], LineBox[{{0, -25.}, {0, 25.}}]}, 
     {AbsoluteThickness[1], Dashing[{0, Small}], 
      LineBox[{{-50, -25.}, {-50, 25.}}], 
      {Dashing[{0, Small, Small, Small}], 
       LineBox[{{-75.75, -25.}, {-75.75, 25.}}]}, 
      {RGBColor[1, 0, 1], Dashing[{Small, Small}], 
       LineBox[{{-86.75811222103108, -25.}, {-86.75811222103108, 25.}}], {
        {RGBColor[0., 0.69, 1.], 
         LineBox[{{-85.44386622893968, -25.}, {-85.44386622893968, 25.}}]}, 
        {RGBColor[0., 0.5175, 0.75], 
         LineBox[{{-91.46417948654718, -25.}, {-91.46417948654718, 25.}}]}, 
        {RGBColor[0., 0.345, 0.5], 
         LineBox[{{-107.1485652907044, -25.}, {-107.1485652907044, 25.}}]}}, {
        {RGBColor[0.9, 0.54, 0.], 
         LineBox[{{-88.3638334207804, -25.}, {-88.3638334207804, 25.}}]}, 
        {RGBColor[0.675, 0.405, 0.], 
         LineBox[{{-98.07568730794594, -25.}, {-98.07568730794594, 
          25.}}]}}}}}, 
    {RGBColor[0, 0, 1], Thickness[Tiny], 
     LineBox[{{-50, 0}, {0, 0}}], {
      LineBox[{{-50, 0}, {0, -43.93366105135426}}], 
      LineBox[{{-50, 0}, {0, -41.44113574117796}}], 
      LineBox[{{-50, 0}, {0, -39.06500432746067}}], 
      LineBox[{{-50, 0}, {0, -36.7936096688596}}], 
      LineBox[{{-50, 0}, {0, -34.616634720805706`}}], 
      LineBox[{{-50, 0}, {0, -32.52490505480626}}], 
      LineBox[{{-50, 0}, {0, -30.510224524313124`}}], 
      LineBox[{{-50, 0}, {0, -28.56523769208289}}], 
      LineBox[{{-50, 0}, {0, -26.683313994506246`}}], 
      LineBox[{{-50, 0}, {0, -24.85844966034016}}], 
      LineBox[{{-50, 0}, {0, -23.08518420530629}}], 
      LineBox[{{-50, 0}, {0, -21.358528948858044`}}], 
      LineBox[{{-50, 0}, {0, -19.673905488215045`}}], 
      LineBox[{{-50, 0}, {0, -18.02709244948355}}], 
      LineBox[{{-50, 0}, {0, -16.414179140188985`}}], 
      LineBox[{{-50, 0}, {0, -14.831524969793385`}}], 
      LineBox[{{-50, 0}, {0, -13.275723698349504`}}], 
      LineBox[{{-50, 0}, {0, -11.743571728713825`}}], 
      LineBox[{{-50, 0}, {0, -10.23203978264131}}], 
      LineBox[{{-50, 0}, {0, -8.738247401730161}}], 
      LineBox[{{-50, 0}, {0, -7.259439795301871}}], 
      LineBox[{{-50, 0}, {0, -5.7929666225552285`}}], 
      LineBox[{{-50, 0}, {0, -4.336262348566149}}], 
      LineBox[{{-50, 0}, {0, -2.886827855119225}}], 
      LineBox[{{-50, 0}, {0, -1.4422130196464216`}}], 
      LineBox[{{-50, 0}, {0, 1.4422130196464207`}}], 
      LineBox[{{-50, 0}, {0, 2.8868278551192232`}}], 
      LineBox[{{-50, 0}, {0, 4.3362623485661524`}}], 
      LineBox[{{-50, 0}, {0, 5.792966622555231}}], 
      LineBox[{{-50, 0}, {0, 7.259439795301873}}], 
      LineBox[{{-50, 0}, {0, 8.738247401730161}}], 
      LineBox[{{-50, 0}, {0, 10.232039782641309`}}], 
      LineBox[{{-50, 0}, {0, 11.743571728713826`}}], 
      LineBox[{{-50, 0}, {0, 13.275723698349504`}}], 
      LineBox[{{-50, 0}, {0, 14.831524969793385`}}], 
      LineBox[{{-50, 0}, {0, 16.414179140188992`}}], 
      LineBox[{{-50, 0}, {0, 18.027092449483554`}}], 
      LineBox[{{-50, 0}, {0, 19.673905488215045`}}], 
      LineBox[{{-50, 0}, {0, 21.358528948858048`}}], 
      LineBox[{{-50, 0}, {0, 23.085184205306295`}}], 
      LineBox[{{-50, 0}, {0, 24.85844966034016}}], 
      LineBox[{{-50, 0}, {0, 26.683313994506253`}}], 
      LineBox[{{-50, 0}, {0, 28.56523769208289}}], 
      LineBox[{{-50, 0}, {0, 30.510224524313124`}}], 
      LineBox[{{-50, 0}, {0, 32.52490505480626}}], 
      LineBox[{{-50, 0}, {0, 34.616634720805706`}}], 
      LineBox[{{-50, 0}, {0, 36.79360966885962}}], 
      LineBox[{{-50, 0}, {0, 39.065004327460684`}}], 
      LineBox[{{-50, 0}, {0, 41.44113574117796}}], 
      LineBox[{{-50, 0}, {0, 43.93366105135426}}]}}, 
    {Hue[0.88, 1., 0.65], Thickness[Tiny], 
     LineBox[{{-125., 0}, {7.575, 0}}], {
      LineBox[{{-125., 16.571840717705193`}, {7.575, -47.60029445855926}}], 
      LineBox[{{-125., 16.6110495232249}, {7.575, -44.959098168200775`}}], 
      LineBox[{{-125., 16.530432212108686`}, {7.575, -42.43408778175857}}], 
      LineBox[{{-125., 16.34351500630462}, {7.575, -40.01371942417455}}], 
      LineBox[{{-125., 16.06221672655471}, {7.575, -37.68777311851575}}], 
      LineBox[{{-125., 15.697066729459806`}, {7.575, -35.44715654493278}}], 
      LineBox[{{-125., 15.257389105783872`}, {7.575, -33.283741910297}}], 
      LineBox[{{-125., 14.75145935130135}, {7.575, -31.190229532911975`}}], 
      LineBox[{{-125., 14.186638411942749`}, {7.575, -29.160033110337054`}}], 
      LineBox[{{-125., 13.569488005973643`}, {7.575, -27.187182682918777`}}], 
      LineBox[{{-125., 12.905870357500277`}, {7.575, -25.266242111812367`}}], 
      LineBox[{{-125., 12.201034879787507`}, {7.575, -23.392238516873967`}}], 
      LineBox[{{-125., 11.459693881371173`}, {7.575, -21.560601610011968`}}], 
      LineBox[{{-125., 10.686089001578935`}, {7.575, -19.767111245417937`}}], 
      LineBox[{{-125., 9.884049791734359}, {7.575, -18.00785181346354}}], 
      LineBox[{{-125., 9.057045626750714}, {7.575, -16.27917234794396}}], 
      LineBox[{{-125., 8.208231946057412}, {7.575, -14.577651410400563`}}], 
      LineBox[{{-125., 7.340491673038272}, {7.575, -12.900065970860002`}}], 
      LineBox[{{-125., 6.4564725409407675`}, {7.575, -11.243363629450384`}}], 
      LineBox[{{-125., 5.558620954839416}, {7.575, -9.604637624138277}}], 
      LineBox[{{-125., 4.649212939330644}, {7.575, -7.9811041510206016`}}], 
      LineBox[{{-125., 3.7303826568311305`}, {7.575, -6.370081588886042}}], 
      LineBox[{{-125., 2.8041489290481314`}, {7.575, -4.7689712719895745`}}], 
      LineBox[{{-125., 1.8724401523882253`}, {7.575, -3.1752394963741764`}}], 
      LineBox[{{-125., 0.9371179652352435}, {7.575, -1.5864004773302505`}}], 
      LineBox[{{-125., -0.937117965235243}, {7.575, 1.5864004773302496`}}], 
      LineBox[{{-125., -1.8724401523882235`}, {7.575, 3.1752394963741746`}}], 
      LineBox[{{-125., -2.8041489290481323`}, {7.575, 4.768971271989578}}], 
      LineBox[{{-125., -3.7303826568311296`}, {7.575, 6.370081588886045}}], 
      LineBox[{{-125., -4.649212939330646}, {7.575, 7.981104151020603}}], 
      LineBox[{{-125., -5.558620954839416}, {7.575, 9.604637624138277}}], 
      LineBox[{{-125., -6.456472540940769}, {7.575, 11.243363629450382`}}], 
      LineBox[{{-125., -7.3404916730382705`}, {7.575, 12.900065970860004`}}], 
      LineBox[{{-125., -8.208231946057412}, {7.575, 14.577651410400563`}}], 
      LineBox[{{-125., -9.057045626750714}, {7.575, 16.27917234794396}}], 
      LineBox[{{-125., -9.884049791734359}, {7.575, 18.007851813463546`}}], 
      LineBox[{{-125., -10.686089001578939`}, {7.575, 19.76711124541794}}], 
      LineBox[{{-125., -11.459693881371173`}, {7.575, 21.560601610011968`}}], 
      LineBox[{{-125., -12.20103487978751}, {7.575, 23.392238516873967`}}], 
      LineBox[{{-125., -12.905870357500273`}, {7.575, 25.26624211181237}}], 
      LineBox[{{-125., -13.569488005973643`}, {7.575, 27.187182682918777`}}], 
      LineBox[{{-125., -14.186638411942749`}, {7.575, 29.160033110337064`}}], 
      LineBox[{{-125., -14.75145935130135}, {7.575, 31.190229532911975`}}], 
      LineBox[{{-125., -15.257389105783872`}, {7.575, 33.283741910297}}], 
      LineBox[{{-125., -15.697066729459806`}, {7.575, 35.44715654493278}}], 
      LineBox[{{-125., -16.06221672655471}, {7.575, 37.68777311851575}}], 
      LineBox[{{-125., -16.34351500630462}, {7.575, 40.01371942417457}}], 
      LineBox[{{-125., -16.53043221210868}, {7.575, 42.434087781758585`}}], 
      LineBox[{{-125., -16.6110495232249}, {7.575, 44.959098168200775`}}], 
      LineBox[{{-125., -16.571840717705193`}, {7.575, 
       47.60029445855926}}]}}}, {{{}, {}, 
     TagBox[
      {RGBColor[1, 0, 0], Thickness[Large], Opacity[1.], FaceForm[Opacity[
       0.3]], LineBox[CompressedData["
1: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
rrKY6VnkKkH53JVtAnKwC5d0mK3wUJauijXiiBTH0hwCLl/naNCbvX9TQrEg
zhAZkG+jzMvd+dVtZAeWZI44VkD59OMLPKmynFh2z4/5GMpWMud2FTlsxBu9
1GbcKR9Y5Bi7bbLaKrlVyfoQ5UCDf9vrqhZafz17J6BF+epwyGNZ/vHWqZq9
xrspJ3MNh5iwDrb6HJMaEKD8wTPj1Nq1l60jDTXdnJQlnEKOKirUtV5V7Fdi
pew6L8e/iq+29salLTBRHijX7tD97tDatTIg/J/tq90sn+7erl+ueb+ChfJM
cl6ARGGkfqiFeP5mytETm4zVDUv0dWrFl7gpm7W+1erAoD9s39AgRtl8h3T3
tvpe/UNXZ4aUKIvWPU9oKPikb7f7pach5Q2t5mFOLdP6ffutHRwoqzbc3Vah
/ls/MeBydRDl7iGbx6KCzMiiI8U7g/Kc/4lVL4HNaKrhyOXa/1wUdOq823ZE
E/7D20+5qfmtbGMFHzqnm8Hy57/3sZoa6lkURoGvxezkqe9z62D9SHqtJGI3
C/lfCuWuw6Jl88vy6MEDzwdAeSVZlDCmKSP/8tKCJcqVKy2Rf+LV0KEP3lXB
VL141m3sypfURWxsMq8aKAv9nr+tmYWQQFom+YfyoMa6TzoyRKDJkpVN1aPP
fkvm0jFTtLvMyHqcspWtws9CsYMon68hUJeq51aBZznhuVYoUO3F9DTl5/0p
rs16JBp0aYRwql+u3OLxpLEeR7dOm3PMU3aUkb6mxuOCyLVy+9NUv8VM8Jel
YVeU2f5q1XORcpAKhPu5o4N/igOyqX7VvYD7XEx8UWly7TsFqr99UkayBk/5
o949xSbPKJeHT+XtbQ1AsH5GeSOVB6+HmuWqC86iQDZzy1oqPzTnOeXNbcLR
qrzO51NMJGSdSZs/oXwBbXhRHCvJTMLEXdf6CekolODqOHibyqOchnK/rWUx
SFnh+fxrKs80zM617HFKQG2CXLvmqHx8n/bheyhfBpI6POY6tpWEyGOVZTvn
M5AJz8jdj9tIiLsUObXal4maWGSCP20nwdBccHSp+ir6wsX8mIePBK77/loK
bdcRq2Nil64YNa9asiz49hcg9LZBIUichOOZ24I5pgrQD9m6grsSJEQN2uhk
5xWivwTPv1HZRYJgAaiV8hQhvcYnHl6yJOS6bJn30CxFohX7enLVqOdbFLGd
DLyL5Ee8r6+pk5DhHqit4FqNlCojF100SGB6NV0jIX8PnWfJj1fVJoG7c+yv
VOkadIvx+TMTouYdd+mfcM37iFU20PjgQRK2WepZqb6vR66NMV8+W5IQECld
vBDegN4uPpS9aEXCF5TgGyveiJ42HstptyFhdUx/t7JfEyrVO2UcaU+C84ip
vLdKC5JbiLbOoebrhMyvxuQ7j5Hjhvbzfp4kfOa3cPrO8QQZJ3LRTE+T0DA2
hxaDn6DokX92sPiSsKHSZWjU6ikSP/dp6k4wCWHXpkrzeJ+hAbYDD29Q8742
+A134sIL9FLO/A1J7R96m7/IAFsPmlvQ+NldQc0js7OWHc49KEwlKoVG7T+U
xaKKWRt70EytpqhbLQmjgXdLBP16Ufdy8FJjMwk0kzjh6ck+VB8k3Yp6SVB5
ZO25X6QfjUyH6jxgooPkPcfPW2KHES9HcMXTDXR4/ILuG8c6grpUWFr+2UQH
4/LLFaFJI2isl7ubfSsdfhRsfDhh8RHJjAUMVgjRod/A64i5yyc0vxA31alG
h1zN79by90aRks76u1xvOmgLnz1T8W0CZbZFP1L1o85XGvnGYTKJDN4Fm3cF
0mF4W56P6e1JdPNyT8DWMDo8/a6z3ebIVyTAnbT7BYMO6uvCjq9fT6G2W9mN
EqV0COv/LRQ5NYPiF8/2eI/TIfvCmevLXxfQdstDWh9CbGHHC9229eMrKGaP
fJ19uC0I9+/7drF4BSUrH6p7F2ULl7KazBnTKyjIQcV8kmELnpphrwSjVtHs
1bOr+jm2cCr2jKRL2Rpalq02fQ620MO3S4aZnYkYiuvro1H7b4eOm32PylkI
/dy67qEmO7i8WZFR8XIzYT4SnmQcYg+KkXOaz534CLaeWyxzIUfhvfGpkw8L
JQikPeXvN+AIo4f+VbJhyBIZXbKxPkvO0Mm+QSJtRYXgyWpkN8OuwPH4iKjn
ohZB5FTl7+M4CTfDf2gVnDAgxPtuu6nnewAne8zEPT1Tosn7/ledQi8QdpIU
ux1oRbA6HKmxueQDrcMGyexSdGKnhYfbyC9/qEk/5V/43oGoeydf8bI7CIxv
ZvDzd7oQs6c3fHmgGgq+YkLtZYnuhJYfc4X/ShhcaGdwdiydJqI7YqW+TkaB
wvF3+tfFA4gQGeconaaLMGudZzB8MJiA3fqPlhbjQSzPd1+bcRjho7Vx46Z9
yWAzEdoIftGEpSprge7vVBja72C1rBpHbDY++iViWxqo/FNzONw4jnBgUpro
lkmDzJtZiNM+jhCQeuVRQ0+Db6P+Ek4X4gjSm2/J9n4auNVtcn76Io54fPx+
pqhOOti7yzfmn4gnDA7V/QxkyYC0lg4G850E4tW3wmErrgzgMt3An1OfQKi2
GsrtE8kAnESQJl0JhLrHX6ySGhmQ5MUn1PszgUj2N+wMOZ0BxOWFIDBPJC6a
MklJvc2Ai8Kvcll/JhI5fxuqlf2bAQX127QeszOI/l8vVbTnMsCrSDU4TYJB
VDYm7YzgyASZ99n8Jy0ZxOH4smsJhpkws+9j1WwRgxBifsjlbp0JizGT/IaP
GMQFp4wWK6dMsJvnKSjtYRCx5+NHjMIy4bDRmH3lOoMYlBD2OMzIhP0JzSUH
+ZKIuaRzph7ZmeD2dLvdukISwUWbvcQoyoSsBuHQNsMk4v/9/xP/B3mJNg0=

        "]]},
      Annotation[#, "Charting`Private`Tag$21818#1"]& ]}, {}}},
  PlotRange->{{-125., 7.575}, {-25., 25.}}]], "Output",
 CellChangeTimes->{3.8916811715640335`*^9, 3.8916815559100485`*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"1e5f8bc4-bea3-41f7-9f8f-cecdbdf6f4f2"],

Cell[BoxData["\<\"C:\\\\Users\\\\Rodrigo.SAOPAULO\\\\Documents\\\\Research\\\\\
pyPSFstack\\\\figures\\\\best_focus\\\\IntAirOil.pdf\"\>"], "Output",
 CellChangeTimes->{3.8916811715640335`*^9, 3.891681556362253*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"66225522-fb11-4809-9c9b-5527623e6bf4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"nr", " ", "=", " ", "1.515"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"getParaxial", "[", "nr", "]"}], ",", 
     RowBox[{"getW4min", "[", "nr", "]"}], ",", 
     RowBox[{"getW6min", "[", "nr", "]"}], ",", 
     RowBox[{"getWmin", "[", "nr", "]"}], ",", 
     RowBox[{"get\[Epsilon]4min", "[", "nr", "]"}], ",", 
     RowBox[{"get\[Epsilon]6min", "[", "nr", "]"}], ",", 
     RowBox[{"getLeastConfusion", "[", 
      RowBox[{
       RowBox[{"1", "/", "nr"}], ",", "nr"}], "]"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8916788332798924`*^9, 3.891678833418463*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"bc1446a6-2b14-4bde-b37d-e61ce0e2efca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.515`", ",", "1.7088773245787936`", ",", "1.8292835897309436`", ",", 
   "2.142971305814088`", ",", "1.767276668415608`", ",", "1.961513746158919`",
    ",", "1.7351622444206216`"}], "}"}]], "Output",
 CellChangeTimes->{3.891678833850947*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"3b604dd6-e3b7-4de7-a9b3-b39e4e289b84"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{865.1999999999999, 820.8},
WindowMargins->{{Automatic, -1155}, {160.80000000000007`, Automatic}},
Magnification:>0.75 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ef2f5b5e-2279-4706-bbcf-6d2823d3669c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 180, 3, 74, "Title",ExpressionUUID->"59ad2c26-9444-4104-9425-54a8a1acfd9b"],
Cell[763, 27, 217, 5, 27, "Text",ExpressionUUID->"5ca0b3ac-9e01-4482-8a25-4c1cdde36ed0"],
Cell[983, 34, 1793, 57, 97, "Input",ExpressionUUID->"14fe8ff0-3b7c-4a1e-bd23-fef16bcbffcf"],
Cell[CellGroupData[{
Cell[2801, 95, 415, 10, 21, "Input",ExpressionUUID->"66ac7375-ea5d-498e-8148-de3ddeb1acbc"],
Cell[3219, 107, 1495, 43, 43, "Output",ExpressionUUID->"3b25f9de-1187-4e00-ac47-620e54f5bf64"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4751, 155, 182, 3, 34, "Subsubsection",ExpressionUUID->"13ac0d7c-0ed8-4d26-bdc7-87ecd94901ef"],
Cell[4936, 160, 234, 4, 22, "Input",ExpressionUUID->"1ab65db4-53b6-4a60-9495-bc514c00fbd5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5207, 169, 171, 3, 34, "Subsubsection",ExpressionUUID->"65b9b499-f0a9-4327-a3e0-4618a0d1dbdf"],
Cell[5381, 174, 284, 6, 27, "Text",ExpressionUUID->"a8514146-93fb-4d68-b2c0-1cbcb21865e2"],
Cell[5668, 182, 2118, 57, 41, "Input",ExpressionUUID->"994c56db-ceb1-430c-90e5-8a7e477a6aad"],
Cell[CellGroupData[{
Cell[7811, 243, 904, 25, 25, "Input",ExpressionUUID->"293c7c6d-2c1d-45d8-9054-93fd15597ae1"],
Cell[8718, 270, 802, 22, 43, "Output",ExpressionUUID->"5b9aba51-b12b-46ad-a409-51b85385daeb"]
}, Open  ]],
Cell[9535, 295, 737, 20, 44, "Input",ExpressionUUID->"54acec7e-2b97-4ab2-872f-f1ff48590824"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10309, 320, 219, 4, 34, "Subsubsection",ExpressionUUID->"37b5d299-314e-4585-a1d3-aa7a6be58f39"],
Cell[10531, 326, 284, 6, 27, "Text",ExpressionUUID->"fb2a9487-6401-47a2-9e40-b5f4fea6ecda"],
Cell[10818, 334, 2168, 58, 41, "Input",ExpressionUUID->"db495f1e-9eb7-4c1a-926a-8aba5a8f0cca"],
Cell[CellGroupData[{
Cell[13011, 396, 904, 25, 25, "Input",ExpressionUUID->"82617b78-4e31-4e40-a174-d8c839fa96f7"],
Cell[13918, 423, 1117, 30, 47, "Output",ExpressionUUID->"4d1e9684-2a79-4e8a-b1f6-ee295f566231"]
}, Open  ]],
Cell[15050, 456, 975, 26, 44, "Input",ExpressionUUID->"e6bc147d-1a10-454a-8120-84adedb69cf3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16062, 487, 164, 3, 34, "Subsubsection",ExpressionUUID->"3e522d5a-85c7-41ac-8bd2-fa60fb856b6d"],
Cell[16229, 492, 2106, 57, 41, "Input",ExpressionUUID->"afa24e15-5599-4999-ae48-a908441cd4c6"],
Cell[CellGroupData[{
Cell[18360, 553, 787, 23, 25, "Input",ExpressionUUID->"57e1a391-a61f-486d-add8-c822a794492e"],
Cell[19150, 578, 1784, 52, 57, "Output",ExpressionUUID->"da0aa79a-c1f6-4183-88b2-293ad6002297"]
}, Open  ]],
Cell[20949, 633, 1466, 48, 49, "Input",ExpressionUUID->"6da59478-de27-411c-be10-ee9c7a46fe32"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22452, 686, 224, 4, 34, "Subsubsection",ExpressionUUID->"6e662ed9-a15c-41fa-ab5b-924c06727112"],
Cell[22679, 692, 2085, 60, 47, "Input",ExpressionUUID->"31b9ccf5-4978-4b73-935c-fe8a067f3b18"],
Cell[CellGroupData[{
Cell[24789, 756, 673, 19, 21, "Input",ExpressionUUID->"f9909284-5920-4f40-aa95-deb81e529274"],
Cell[25465, 777, 748, 21, 43, "Output",ExpressionUUID->"89b0442e-5024-46cd-b15a-b36bff679e5e"]
}, Open  ]],
Cell[26228, 801, 638, 17, 40, "Input",ExpressionUUID->"c76a3a6d-52d9-45ee-963d-099d024e50d0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26903, 823, 264, 4, 34, "Subsubsection",ExpressionUUID->"35d66903-84b7-4229-9b1d-13f705402a03"],
Cell[27170, 829, 2106, 60, 47, "Input",ExpressionUUID->"d9d05580-2c2c-42b7-b948-5178c5d821bf"],
Cell[CellGroupData[{
Cell[29301, 893, 605, 18, 21, "Input",ExpressionUUID->"fcf2239e-66f2-41b2-a068-326f23d59bba"],
Cell[29909, 913, 800, 24, 43, "Output",ExpressionUUID->"4b7dad52-7989-422d-982e-35bbdb87fa05"]
}, Open  ]],
Cell[30724, 940, 917, 24, 40, "Input",ExpressionUUID->"4cb4401c-2774-48ae-96e0-2e2f7d40869d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31678, 969, 159, 3, 34, "Subsubsection",ExpressionUUID->"1c7fc80f-639e-4ad9-abfc-8cd4176b12a0"],
Cell[31840, 974, 1750, 49, 66, "Input",ExpressionUUID->"14562c5e-b1f5-427c-b07c-11cc23df7da8"],
Cell[33593, 1025, 258, 6, 27, "Text",ExpressionUUID->"5b25d158-ee6d-4638-8de0-5b3651053232"],
Cell[33854, 1033, 1587, 45, 109, "Input",ExpressionUUID->"b142235b-8962-495a-a165-532e034c2a47"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35478, 1083, 189, 4, 41, "Subsection",ExpressionUUID->"e4442799-526a-4e22-a5c1-742ba2eafc46"],
Cell[CellGroupData[{
Cell[35692, 1091, 1248, 25, 36, "Input",ExpressionUUID->"7afc98e7-8467-4cd9-8c95-1c11c819cd8a"],
Cell[36943, 1118, 766, 13, 24, "Output",ExpressionUUID->"b4b9220c-3f1f-47e5-a95b-51fb927c9a05"]
}, Open  ]],
Cell[37724, 1134, 14296, 332, 512, "Input",ExpressionUUID->"89d5599d-cd68-427b-891b-fa0f52a3a4f6"],
Cell[CellGroupData[{
Cell[52045, 1470, 492, 10, 22, "Input",ExpressionUUID->"cf9ade2b-92f7-4145-8a4c-f48c75d920ab"],
Cell[52540, 1482, 336, 5, 24, "Output",ExpressionUUID->"55b7517b-027b-4cbd-873e-5f0d89bf6f3a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52913, 1492, 578, 12, 36, "Input",ExpressionUUID->"5ba6ca9b-1cc6-4c9a-b10d-8dc8dec51970"],
Cell[53494, 1506, 14699, 273, 116, "Output",ExpressionUUID->"a9a0fab4-157b-4bcd-8454-92110ece9abb"],
Cell[68196, 1781, 392, 5, 24, "Output",ExpressionUUID->"80f6f714-cfa4-4b6d-aefc-fc8bd1687516"]
}, Open  ]],
Cell[68603, 1789, 711, 17, 36, "Input",ExpressionUUID->"56f97bdd-d924-4d11-acd9-757238c1ab38"],
Cell[CellGroupData[{
Cell[69339, 1810, 521, 11, 36, "Input",ExpressionUUID->"1311847e-f1a2-4cb4-8c96-4559d0d3d1e4"],
Cell[69863, 1823, 13479, 221, 114, "Output",ExpressionUUID->"1e5f8bc4-bea3-41f7-9f8f-cecdbdf6f4f2"],
Cell[83345, 2046, 294, 3, 76, "Output",ExpressionUUID->"66225522-fb11-4809-9c9b-5527623e6bf4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83676, 2054, 774, 18, 36, "Input",ExpressionUUID->"bc1446a6-2b14-4bde-b37d-e61ce0e2efca"],
Cell[84453, 2074, 365, 7, 24, "Output",ExpressionUUID->"3b604dd6-e3b7-4de7-a9b3-b39e4e289b84"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

