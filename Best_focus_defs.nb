(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     92474,       2232]
NotebookOptionsPosition[     86311,       2123]
NotebookOutlinePosition[     86709,       2139]
CellTagsIndexPosition[     86666,       2136]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Derivation of criteria for best focus", "Title",
 CellChangeTimes->{{3.891586495349483*^9, 
  3.891586505796176*^9}},ExpressionUUID->"59ad2c26-9444-4104-9425-\
54a8a1acfd9b"],

Cell["\<\
Define the wavefront error and its approximation up to fourth order\
\>", "Text",
 CellChangeTimes->{{3.891586513884419*^9, 
  3.891586538166326*^9}},ExpressionUUID->"5ca0b3ac-9e01-4482-8a25-\
4c1cdde36ed0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"abeW", "[", 
   RowBox[{"u_", ",", "nr_", ",", "\[Alpha]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["1", "nr"], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox[
       RowBox[{"(", " ", 
        RowBox[{"nr", " ", "u"}], ")"}], "2"]}]]}], "-", " ", 
   RowBox[{"\[Alpha]", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["u", "2"]}]]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"abeW4th", "[", 
   RowBox[{"u_", ",", "nr_", ",", "\[Alpha]_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", "nr"], "-", "\[Alpha]", "-", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"nr", "-", "\[Alpha]"}], ")"}], 
    SuperscriptBox["u", "2"]}], "-", 
   RowBox[{
    FractionBox["1", "8"], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["nr", "3"], "-", "\[Alpha]"}], ")"}], 
    SuperscriptBox["u", "4"]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"abeW6th", "[", 
   RowBox[{"u_", ",", "nr_", ",", "\[Alpha]_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", "nr"], "-", "\[Alpha]", "-", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"nr", "-", "\[Alpha]"}], ")"}], 
    SuperscriptBox["u", "2"]}], "-", 
   RowBox[{
    FractionBox["1", "8"], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["nr", "3"], "-", "\[Alpha]"}], ")"}], 
    SuperscriptBox["u", "4"]}], "-", 
   RowBox[{
    FractionBox["1", "16"], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["nr", "5"], "-", "\[Alpha]"}], ")"}], " ", 
    SuperscriptBox["u", "6"]}]}]}]}], "Input",
 CellChangeTimes->{{3.891664943185691*^9, 3.891665015366991*^9}, {
  3.891665179994274*^9, 3.891665192043912*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"14fe8ff0-3b7c-4a1e-bd23-fef16bcbffcf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"abeW", "[", 
    RowBox[{"u", ",", "nr", ",", "\[Alpha]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"u", ",", "0", ",", "6"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.891587700747219*^9, 3.8915877285838842`*^9}, 
   3.891587901429203*^9, 3.891664987385065*^9},
 CellLabel->
  "In[192]:=",ExpressionUUID->"66ac7375-ea5d-498e-8148-de3ddeb1acbc"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "nr"], "-", "\[Alpha]"}], ")"}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "nr"}], "+", "\[Alpha]"}], ")"}], " ", 
    SuperscriptBox["u", "2"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["nr", "3"], "8"]}], "+", 
      FractionBox["\[Alpha]", "8"]}], ")"}], " ", 
    SuperscriptBox["u", "4"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["nr", "5"], "16"]}], "+", 
      FractionBox["\[Alpha]", "16"]}], ")"}], " ", 
    SuperscriptBox["u", "6"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "u", "]"}], "7"],
    SeriesData[$CellContext`u, 0, {}, 0, 7, 1],
    Editable->False]}],
  SeriesData[$CellContext`u, 
   0, {$CellContext`nr^(-1) - $CellContext`\[Alpha], 0, 
    Rational[1, 2] (-$CellContext`nr + $CellContext`\[Alpha]), 0, 
    Rational[-1, 8] $CellContext`nr^3 + Rational[1, 8] $CellContext`\[Alpha], 
    0, Rational[-1, 16] $CellContext`nr^5 + 
    Rational[1, 16] $CellContext`\[Alpha]}, 0, 7, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.8915877239525433`*^9, 3.891587729437675*^9}, 
   3.8915879017585077`*^9, 3.89166498830903*^9, 3.891665196069345*^9},
 CellLabel->
  "Out[192]=",ExpressionUUID->"3b25f9de-1187-4e00-ac47-620e54f5bf64"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Paraxial (second order W rms)", "Subsubsection",
 CellChangeTimes->{{3.8915873736144037`*^9, 
  3.891587387547757*^9}},ExpressionUUID->"13ac0d7c-0ed8-4d26-bdc7-\
87ecd94901ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getParaxial", "[", "nr_", "]"}], ":=", "nr"}]], "Input",
 CellChangeTimes->{{3.89158739543491*^9, 3.891587399253067*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"1ab65db4-53b6-4a60-9495-bc514c00fbd5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fourth order W rms", "Subsubsection",
 CellChangeTimes->{{3.8915256412649097`*^9, 
  3.891525649478364*^9}},ExpressionUUID->"65b9b499-f0a9-4327-a3e0-\
4618a0d1dbdf"],

Cell["\<\
Note that the nr multiplying the terms is there because the definition is \
with u running from 0 to 1 (the SA).\
\>", "Text",
 CellChangeTimes->{{3.891588045055072*^9, 3.891588080440371*^9}, 
   3.89158838461668*^9},ExpressionUUID->"a8514146-93fb-4d68-b2c0-\
1cbcb21865e2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Wmean", "[", 
    RowBox[{"\[Alpha]_", ",", "nr_"}], "]"}], "=", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nr", ">", "1"}], ",", 
       RowBox[{"\[Alpha]", "\[Element]", "Reals"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["nr", "2"], " ", 
         RowBox[{"abeW4th", "[", 
          RowBox[{"u", ",", "nr", ",", "\[Alpha]"}], "]"}], "u"}], ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "0", ",", 
          RowBox[{"1", "/", "nr"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "/", "\[Pi]"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"W2mean", "[", 
    RowBox[{"\[Alpha]_", ",", "nr_"}], "]"}], " ", "=", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Alpha]", "\[Element]", "Reals"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["nr", "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"abeW4th", "[", 
            RowBox[{"u", ",", "nr", ",", "\[Alpha]"}], "]"}], " ", ")"}], 
          "2"], "u"}], " ", ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "0", ",", 
          RowBox[{"1", "/", "nr"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "/", "\[Pi]"}]}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.891586885230776*^9, 3.8915868874932013`*^9}, {
   3.891587248482608*^9, 3.891587262314685*^9}, {3.891588090236438*^9, 
   3.891588095863696*^9}, {3.8915882774217043`*^9, 3.891588279315867*^9}, 
   3.8915884452960787`*^9, {3.89159191441186*^9, 3.8915919175727873`*^9}, 
   3.8916098286019917`*^9, {3.891665046428026*^9, 3.891665069094149*^9}, {
   3.891665112965384*^9, 3.891665115891824*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"994c56db-ceb1-430c-90e5-8a7e477a6aad"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"nr", ">", "1"}], ",", 
         RowBox[{"\[Alpha]", "\[Element]", "Reals"}]}], "}"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{"W2mean", "[", 
            RowBox[{"\[Alpha]", ",", "nr"}], "]"}], "-", 
           SuperscriptBox[
            RowBox[{"Wmean", "[", 
             RowBox[{"\[Alpha]", ",", "nr"}], "]"}], "2"]}], ")"}], ",", 
         "\[Alpha]"}], "]"}]}], "]"}], "\[Equal]", "0"}], ",", "\[Alpha]"}], 
   "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.891586890347822*^9, 3.891586890719388*^9}, {
  3.891665126488613*^9, 3.8916651568100233`*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"293c7c6d-2c1d-45d8-9054-93fd15597ae1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Alpha]", "\[Rule]", 
    FractionBox[
     RowBox[{
      SuperscriptBox["nr", "3"], " ", 
      RowBox[{"(", 
       RowBox[{"19", "+", 
        RowBox[{"75", " ", 
         SuperscriptBox["nr", "2"]}]}], ")"}]}], 
     RowBox[{"4", "+", 
      RowBox[{"30", " ", 
       SuperscriptBox["nr", "2"]}], "+", 
      RowBox[{"60", " ", 
       SuperscriptBox["nr", "4"]}]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.891586893224965*^9, 3.891586923406843*^9, 3.891587286566557*^9, 
   3.891588117056252*^9, 3.8915882875602407`*^9, 3.891588454496043*^9, 
   3.8916098461992607`*^9, {3.891665130932469*^9, 3.891665157891439*^9}, 
   3.891665207822391*^9},
 CellLabel->
  "Out[195]=",ExpressionUUID->"5b9aba51-b12b-46ad-a409-51b85385daeb"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"getW4min", "[", "nr_", "]"}], ":=", 
  FractionBox[
   RowBox[{
    SuperscriptBox["nr", "3"], " ", 
    RowBox[{"(", 
     RowBox[{"19", "+", 
      RowBox[{"75", " ", 
       SuperscriptBox["nr", "2"]}]}], ")"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", 
      RowBox[{"15", " ", 
       SuperscriptBox["nr", "2"]}], "+", 
      RowBox[{"30", " ", 
       SuperscriptBox["nr", "4"]}]}], ")"}]}]]}]], "Input",
 CellChangeTimes->{{3.89158759791214*^9, 3.891587606155809*^9}, 
   3.8915881512947683`*^9, 3.891588474479864*^9, 3.891609941864087*^9, {
   3.891665229041452*^9, 3.8916652336997957`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"54acec7e-2b97-4ab2-872f-f1ff48590824"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sixth order W rms", "Subsubsection",
 CellChangeTimes->{{3.8915256412649097`*^9, 3.891525649478364*^9}, {
  3.891665242933816*^9, 
  3.891665247730854*^9}},ExpressionUUID->"37b5d299-314e-4585-a1d3-\
aa7a6be58f39"],

Cell["\<\
Note that the nr multiplying the terms is there because the definition is \
with u running from 0 to 1 (the SA).\
\>", "Text",
 CellChangeTimes->{{3.891588045055072*^9, 3.891588080440371*^9}, 
   3.89158838461668*^9},ExpressionUUID->"fb2a9487-6401-47a2-9e40-\
b5f4fea6ecda"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Wmean", "[", 
    RowBox[{"\[Alpha]_", ",", "nr_"}], "]"}], "=", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nr", ">", "1"}], ",", 
       RowBox[{"\[Alpha]", "\[Element]", "Reals"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["nr", "2"], " ", 
         RowBox[{"abeW6th", "[", 
          RowBox[{"u", ",", "nr", ",", "\[Alpha]"}], "]"}], "u"}], ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "0", ",", 
          RowBox[{"1", "/", "nr"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "/", "\[Pi]"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"W2mean", "[", 
    RowBox[{"\[Alpha]_", ",", "nr_"}], "]"}], " ", "=", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Alpha]", "\[Element]", "Reals"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["nr", "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"abeW6th", "[", 
            RowBox[{"u", ",", "nr", ",", "\[Alpha]"}], "]"}], " ", ")"}], 
          "2"], "u"}], " ", ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "0", ",", 
          RowBox[{"1", "/", "nr"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "/", "\[Pi]"}]}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.891586885230776*^9, 3.8915868874932013`*^9}, {
   3.891587248482608*^9, 3.891587262314685*^9}, {3.891588090236438*^9, 
   3.891588095863696*^9}, {3.8915882774217043`*^9, 3.891588279315867*^9}, 
   3.8915884452960787`*^9, {3.89159191441186*^9, 3.8915919175727873`*^9}, 
   3.8916098286019917`*^9, {3.891665046428026*^9, 3.891665069094149*^9}, {
   3.891665112965384*^9, 3.891665115891824*^9}, {3.891665256982626*^9, 
   3.891665260429121*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"db495f1e-9eb7-4c1a-926a-8aba5a8f0cca"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"nr", ">", "1"}], ",", 
         RowBox[{"\[Alpha]", "\[Element]", "Reals"}]}], "}"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{"W2mean", "[", 
            RowBox[{"\[Alpha]", ",", "nr"}], "]"}], "-", 
           SuperscriptBox[
            RowBox[{"Wmean", "[", 
             RowBox[{"\[Alpha]", ",", "nr"}], "]"}], "2"]}], ")"}], ",", 
         "\[Alpha]"}], "]"}]}], "]"}], "\[Equal]", "0"}], ",", "\[Alpha]"}], 
   "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.891586890347822*^9, 3.891586890719388*^9}, {
  3.891665126488613*^9, 3.8916651568100233`*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"82617b78-4e31-4e40-a174-d8c839fa96f7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Alpha]", "\[Rule]", 
    FractionBox[
     RowBox[{
      SuperscriptBox["nr", "5"], " ", 
      RowBox[{"(", 
       RowBox[{"4269", "+", 
        RowBox[{"9352", " ", 
         SuperscriptBox["nr", "2"]}], "+", 
        RowBox[{"36624", " ", 
         SuperscriptBox["nr", "4"]}]}], ")"}]}], 
     RowBox[{"5", " ", 
      RowBox[{"(", 
       RowBox[{"81", "+", 
        RowBox[{"336", " ", 
         SuperscriptBox["nr", "2"]}], "+", 
        RowBox[{"1568", " ", 
         SuperscriptBox["nr", "4"]}], "+", 
        RowBox[{"2688", " ", 
         SuperscriptBox["nr", "6"]}], "+", 
        RowBox[{"5376", " ", 
         SuperscriptBox["nr", "8"]}]}], ")"}]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.891586893224965*^9, 3.891586923406843*^9, 3.891587286566557*^9, 
   3.891588117056252*^9, 3.8915882875602407`*^9, 3.891588454496043*^9, 
   3.8916098461992607`*^9, {3.891665130932469*^9, 3.891665157891439*^9}, 
   3.891665207822391*^9, 3.89166527872865*^9},
 CellLabel->
  "Out[199]=",ExpressionUUID->"4d1e9684-2a79-4e8a-b1f6-ee295f566231"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"getW6min", "[", "nr_", "]"}], ":=", 
  FractionBox[
   RowBox[{
    SuperscriptBox["nr", "5"], " ", 
    RowBox[{"(", 
     RowBox[{"4269", "+", 
      RowBox[{"9352", " ", 
       SuperscriptBox["nr", "2"]}], "+", 
      RowBox[{"36624", " ", 
       SuperscriptBox["nr", "4"]}]}], ")"}]}], 
   RowBox[{"5", " ", 
    RowBox[{"(", 
     RowBox[{"81", "+", 
      RowBox[{"336", " ", 
       SuperscriptBox["nr", "2"]}], "+", 
      RowBox[{"1568", " ", 
       SuperscriptBox["nr", "4"]}], "+", 
      RowBox[{"2688", " ", 
       SuperscriptBox["nr", "6"]}], "+", 
      RowBox[{"5376", " ", 
       SuperscriptBox["nr", "8"]}]}], ")"}]}]]}]], "Input",
 CellChangeTimes->{{3.89158759791214*^9, 3.891587606155809*^9}, 
   3.8915881512947683`*^9, 3.891588474479864*^9, 3.891609941864087*^9, {
   3.891665229041452*^9, 3.89166525179145*^9}, 3.891665285407243*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"e6bc147d-1a10-454a-8120-84adedb69cf3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Whole W rms", "Subsubsection",
 CellChangeTimes->{{3.891525732979652*^9, 
  3.8915257402953672`*^9}},ExpressionUUID->"3e522d5a-85c7-41ac-8bd2-\
fa60fb856b6d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Wmean", "[", 
    RowBox[{"\[Alpha]_", ",", "nr_"}], "]"}], "=", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nr", ">", "1"}], ",", 
       RowBox[{"\[Alpha]", "\[Element]", "Reals"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["nr", "2"], " ", 
         RowBox[{"abeW", "[", 
          RowBox[{"u", ",", "nr", ",", "\[Alpha]"}], "]"}], "u"}], ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "0", ",", 
          RowBox[{"1", "/", "nr"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "/", "\[Pi]"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"W2mean", "[", 
    RowBox[{"\[Alpha]_", ",", "nr_"}], "]"}], " ", "=", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Alpha]", "\[Element]", "Reals"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["nr", "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"abeW", "[", 
            RowBox[{"u", ",", "nr", ",", "\[Alpha]"}], "]"}], ")"}], "2"], 
         "u"}], " ", ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "0", ",", 
          RowBox[{"1", "/", "nr"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "/", "\[Pi]"}]}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.891586885230776*^9, 3.8915868874932013`*^9}, {
   3.891587248482608*^9, 3.891587262314685*^9}, {3.891588090236438*^9, 
   3.891588095863696*^9}, {3.8915882774217043`*^9, 3.891588279315867*^9}, 
   3.8915884452960787`*^9, {3.89159191441186*^9, 3.8915919175727873`*^9}, 
   3.8916098286019917`*^9, {3.89161039787192*^9, 3.891610415278857*^9}, {
   3.8916660089149446`*^9, 3.89166601016931*^9}},
 CellLabel->
  "In[202]:=",ExpressionUUID->"afa24e15-5599-4999-ae48-a908441cd4c6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"nr", ">", "1"}], ",", 
         RowBox[{"\[Alpha]", "\[Element]", "Reals"}]}], "}"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{"W2mean", "[", 
            RowBox[{"\[Alpha]", ",", "nr"}], "]"}], "-", 
           SuperscriptBox[
            RowBox[{"Wmean", "[", 
             RowBox[{"\[Alpha]", ",", "nr"}], "]"}], "2"]}], ")"}], ",", 
         "\[Alpha]"}], "]"}]}], "]"}], "\[Equal]", "0"}], ",", "\[Alpha]"}], 
   "]"}], "//", "Simplify"}]], "Input",
 CellLabel->
  "In[204]:=",ExpressionUUID->"57e1a391-a61f-486d-add8-c822a794492e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Alpha]", "\[Rule]", 
    TemplateBox[{
      FractionBox[
       RowBox[{
         RowBox[{
           RowBox[{"-", "9"}], " ", "nr"}], "+", 
         RowBox[{"7", " ", 
           SuperscriptBox["nr", "3"]}], "+", 
         RowBox[{"16", " ", 
           SqrtBox[
            RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["nr", "2"]}]]}], "-", 
         RowBox[{"16", " ", 
           SuperscriptBox["nr", "2"], " ", 
           SqrtBox[
            RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["nr", "2"]}]]}], "+", 
         RowBox[{"9", " ", 
           SuperscriptBox[
            RowBox[{"(", 
              RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["nr", "2"]}], ")"}], "2"], " ", 
           RowBox[{"ArcCoth", "[", "nr", "]"}]}]}], 
       RowBox[{"2", "+", 
         RowBox[{"12", " ", 
           SuperscriptBox["nr", "2"]}], "-", 
         RowBox[{"48", " ", 
           SuperscriptBox["nr", "4"]}], "+", 
         RowBox[{"32", " ", 
           SuperscriptBox["nr", "6"]}], "+", 
         RowBox[{"32", " ", 
           SuperscriptBox["nr", "3"], " ", 
           SqrtBox[
            RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["nr", "2"]}]]}], "-", 
         RowBox[{"32", " ", 
           SuperscriptBox["nr", "5"], " ", 
           SqrtBox[
            RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["nr", "2"]}]]}]}]], 
      RowBox[{"nr", ">", "1"}]},
     "ConditionalExpression"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.8916660378079443`*^9},
 CellLabel->
  "Out[204]=",ExpressionUUID->"da0aa79a-c1f6-4183-88b2-293ad6002297"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"getWmin", "[", "nr_", "]"}], ":=", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", "9"}], " ", "nr"}], "+", 
    RowBox[{"7", " ", 
     SuperscriptBox["nr", "3"]}], "+", 
    RowBox[{"16", " ", 
     SqrtBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["nr", "2"]}]]}], "-", 
    RowBox[{"16", " ", 
     SuperscriptBox["nr", "2"], " ", 
     SqrtBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["nr", "2"]}]]}], "+", 
    RowBox[{"9", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["nr", "2"]}], ")"}], "2"], " ", 
     RowBox[{"ArcCoth", "[", "nr", "]"}]}]}], 
   RowBox[{"2", "+", 
    RowBox[{"12", " ", 
     SuperscriptBox["nr", "2"]}], "-", 
    RowBox[{"48", " ", 
     SuperscriptBox["nr", "4"]}], "+", 
    RowBox[{"32", " ", 
     SuperscriptBox["nr", "6"]}], "+", 
    RowBox[{"32", " ", 
     SuperscriptBox["nr", "3"], " ", 
     SqrtBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["nr", "2"]}]]}], "-", 
    RowBox[{"32", " ", 
     SuperscriptBox["nr", "5"], " ", 
     SqrtBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["nr", "2"]}]]}]}]]}]], "Input",
 CellChangeTimes->{
  3.891610697384433*^9, {3.8916107621232758`*^9, 3.891610775296753*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"6da59478-de27-411c-be10-ee9c7a46fe32"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Min spot size 4th order", "Subsubsection",
 CellChangeTimes->{{3.8915271916207933`*^9, 3.891527195366624*^9}, {
  3.891612003516464*^9, 
  3.89161200560927*^9}},ExpressionUUID->"6e662ed9-a15c-41fa-ab5b-\
924c06727112"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]x", "[", 
    RowBox[{"u_", ",", "\[Phi]_", ",", "\[Alpha]_", ",", "nr_"}], "]"}], "=", 
   
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"abeW4th", "[", 
          RowBox[{"u", ",", "nr", ",", "\[Alpha]"}], "]"}], "/.", 
         RowBox[{"u", "\[Rule]", 
          RowBox[{"(", 
           SqrtBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["ux", "2"], "+", 
              SuperscriptBox["uy", "2"]}], ")"}]], ")"}]}]}], ",", "ux"}], 
       "]"}], "/.", 
      RowBox[{"ux", "\[Rule]", 
       RowBox[{"u", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}]}], "/.", 
     RowBox[{"uy", "\[Rule]", 
      RowBox[{"u", " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]2mean", "[", 
    RowBox[{"\[Alpha]_", ",", "nr_"}], "]"}], " ", "=", " ", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nr", ">", "1"}], ",", 
       RowBox[{"\[Alpha]", "\[Element]", "Reals"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["nr", "2"], " ", 
         SuperscriptBox[
          RowBox[{"\[Epsilon]x", " ", "[", 
           RowBox[{"u", ",", "f", ",", "\[Alpha]", ",", "nr"}], "]"}], "2"], 
         "u"}], ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "0", ",", 
          RowBox[{"1", "/", "nr"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "/", "\[Pi]"}]}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.891611390798094*^9, 3.891611543574786*^9}, {
   3.891611604148979*^9, 3.89161163493124*^9}, 3.891611695009645*^9, {
   3.8916661075310297`*^9, 3.8916661216228037`*^9}, {3.891666266534336*^9, 
   3.8916662678948603`*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"31b9ccf5-4978-4b73-935c-fe8a067f3b18"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"nr", ">", "1"}], ",", 
         RowBox[{"\[Alpha]", "\[Element]", "Reals"}]}], "}"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Epsilon]2mean", "[", 
          RowBox[{"\[Alpha]", ",", "nr"}], "]"}], ",", "\[Alpha]"}], "]"}]}], 
      "]"}], "\[Equal]", "0"}], ",", "\[Alpha]"}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.8916663153852873`*^9, 3.891666326049119*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"f9909284-5920-4f40-aa95-deb81e529274"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Alpha]", "\[Rule]", 
    FractionBox[
     RowBox[{
      SuperscriptBox["nr", "3"], " ", 
      RowBox[{"(", 
       RowBox[{"11", "+", 
        RowBox[{"32", " ", 
         SuperscriptBox["nr", "2"]}]}], ")"}]}], 
     RowBox[{"3", "+", 
      RowBox[{"16", " ", 
       SuperscriptBox["nr", "2"]}], "+", 
      RowBox[{"24", " ", 
       SuperscriptBox["nr", "4"]}]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.891611386929915*^9, 3.8916114248032*^9, 3.8916114694707117`*^9, {
   3.891611523977584*^9, 3.89161154400511*^9}, 3.891611635497232*^9, 
   3.89161170532585*^9, 3.891666364215625*^9},
 CellLabel->
  "Out[207]=",ExpressionUUID->"89b0442e-5024-46cd-b15a-b36bff679e5e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"get\[Epsilon]4min", "[", "nr_", "]"}], ":=", 
  FractionBox[
   RowBox[{
    SuperscriptBox["nr", "3"], " ", 
    RowBox[{"(", 
     RowBox[{"11", "+", 
      RowBox[{"32", " ", 
       SuperscriptBox["nr", "2"]}]}], ")"}]}], 
   RowBox[{"3", "+", 
    RowBox[{"16", " ", 
     SuperscriptBox["nr", "2"]}], "+", 
    RowBox[{"24", " ", 
     SuperscriptBox["nr", "4"]}]}]]}]], "Input",
 CellChangeTimes->{{3.891611867625679*^9, 3.891611892533559*^9}, 
   3.8916119430612926`*^9, {3.891666141463709*^9, 3.891666146213204*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"c76a3a6d-52d9-45ee-963d-099d024e50d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Min spot size 6th", "Subsubsection",
 CellChangeTimes->{{3.8915271916207933`*^9, 3.891527195366624*^9}, {
  3.891612003516464*^9, 3.891612016884411*^9}, {3.891664516695654*^9, 
  3.89166451722122*^9}},ExpressionUUID->"35d66903-84b7-4229-9b1d-\
13f705402a03"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]x", "[", 
    RowBox[{"u_", ",", "\[Phi]_", ",", "\[Alpha]_", ",", "nr_"}], "]"}], "=", 
   
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"abeW6th", "[", 
          RowBox[{"u", ",", "nr", ",", "\[Alpha]"}], "]"}], "/.", 
         RowBox[{"u", "\[Rule]", 
          RowBox[{"(", 
           SqrtBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["ux", "2"], "+", 
              SuperscriptBox["uy", "2"]}], ")"}]], ")"}]}]}], ",", "ux"}], 
       "]"}], "/.", 
      RowBox[{"ux", "\[Rule]", 
       RowBox[{"u", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}]}], "/.", 
     RowBox[{"uy", "\[Rule]", 
      RowBox[{"u", " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]2mean", "[", 
    RowBox[{"\[Alpha]_", ",", "nr_"}], "]"}], " ", "=", " ", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nr", ">", "1"}], ",", 
       RowBox[{"\[Alpha]", "\[Element]", "Reals"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["nr", "2"], " ", 
         SuperscriptBox[
          RowBox[{"\[Epsilon]x", " ", "[", 
           RowBox[{"u", ",", "f", ",", "\[Alpha]", ",", "nr"}], "]"}], "2"], 
         "u"}], ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "0", ",", 
          RowBox[{"1", "/", "nr"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "/", "\[Pi]"}]}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.891611390798094*^9, 3.891611543574786*^9}, {
   3.891611604148979*^9, 3.89161163493124*^9}, 3.891611695009645*^9, {
   3.8916661075310297`*^9, 3.8916661216228037`*^9}, {3.891666266534336*^9, 
   3.8916662678948603`*^9}, 3.89166640282023*^9},
 CellLabel->
  "In[208]:=",ExpressionUUID->"d9d05580-2c2c-42b7-b948-5178c5d821bf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"nr", ">", "1"}], ",", 
         RowBox[{"\[Alpha]", "\[Element]", "Reals"}]}], "}"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Epsilon]2mean", "[", 
          RowBox[{"\[Alpha]", ",", "nr"}], "]"}], ",", "\[Alpha]"}], "]"}]}], 
      "]"}], "\[Equal]", "0"}], ",", "\[Alpha]"}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellLabel->
  "In[210]:=",ExpressionUUID->"fcf2239e-66f2-41b2-a068-326f23d59bba"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Alpha]", "\[Rule]", 
    FractionBox[
     RowBox[{
      SuperscriptBox["nr", "5"], " ", 
      RowBox[{"(", 
       RowBox[{"297", "+", 
        RowBox[{"512", " ", 
         SuperscriptBox["nr", "2"]}], "+", 
        RowBox[{"1460", " ", 
         SuperscriptBox["nr", "4"]}]}], ")"}]}], 
     RowBox[{"45", "+", 
      RowBox[{"144", " ", 
       SuperscriptBox["nr", "2"]}], "+", 
      RowBox[{"480", " ", 
       SuperscriptBox["nr", "4"]}], "+", 
      RowBox[{"640", " ", 
       SuperscriptBox["nr", "6"]}], "+", 
      RowBox[{"960", " ", 
       SuperscriptBox["nr", "8"]}]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.891666422151457*^9},
 CellLabel->
  "Out[210]=",ExpressionUUID->"4b7dad52-7989-422d-982e-35bbdb87fa05"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"get\[Epsilon]6min", "[", "nr_", "]"}], ":=", 
  FractionBox[
   RowBox[{
    SuperscriptBox["nr", "5"], " ", 
    RowBox[{"(", 
     RowBox[{"297", "+", 
      RowBox[{"512", " ", 
       SuperscriptBox["nr", "2"]}], "+", 
      RowBox[{"1460", " ", 
       SuperscriptBox["nr", "4"]}]}], ")"}]}], 
   RowBox[{"45", "+", 
    RowBox[{"144", " ", 
     SuperscriptBox["nr", "2"]}], "+", 
    RowBox[{"480", " ", 
     SuperscriptBox["nr", "4"]}], "+", 
    RowBox[{"640", " ", 
     SuperscriptBox["nr", "6"]}], "+", 
    RowBox[{"960", " ", 
     SuperscriptBox["nr", "8"]}]}]]}]], "Input",
 CellChangeTimes->{{3.891611867625679*^9, 3.891611892533559*^9}, 
   3.8916119430612926`*^9, {3.891612367331818*^9, 3.8916123893860273`*^9}, 
   3.891612508753971*^9, 3.8916647503301497`*^9, 3.891666160216291*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"4cb4401c-2774-48ae-96e0-2e2f7d40869d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Confusion", "Subsubsection",
 CellChangeTimes->{{3.89161269058197*^9, 
  3.891612692529151*^9}},ExpressionUUID->"1c7fc80f-639e-4ad9-abfc-\
8cd4176b12a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getLeastConfusion", "[", 
   RowBox[{"smax_", ",", "nr_"}], "]"}], ":=", 
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{"x", "/.", 
     RowBox[{
      RowBox[{"NSolve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                FractionBox[
                 RowBox[{" ", "smax"}], 
                 RowBox[{
                  SqrtBox[
                   RowBox[{"1", "-", 
                    SuperscriptBox["smax", "2"]}]], " "}]], "+", 
                FractionBox[
                 RowBox[{"smax", " ", "x"}], 
                 RowBox[{"nr", " ", 
                  SqrtBox[
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox["smax", "2"], " "}], 
                    SuperscriptBox["nr", "2"]]}]]}]]}], ")"}], 
              SqrtBox[
               RowBox[{"1", "-", 
                SuperscriptBox[
                 RowBox[{"(", 
                  FractionBox["1", "nr"], ")"}], "2"]}]]}], ")"}], 
            RowBox[{"2", "/", "3"}]]}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", 
             FractionBox["x", "nr"]}], ")"}], 
           RowBox[{"2", "/", "3"}]]}], "\[Equal]", "1"}], ",", "x"}], "]"}], 
      "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.89166772725219*^9, 3.891667802534791*^9}, {
  3.891667841695862*^9, 3.891667982652577*^9}, {3.8916680781932983`*^9, 
  3.891668105085793*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"14562c5e-b1f5-427c-b07c-11cc23df7da8"],

Cell["\<\
\[Theta] is the angle of the ray emerging from the source, x the position \
with the zero at the interface\
\>", "Text",
 CellChangeTimes->{{3.891667534220386*^9, 
  3.8916675658512497`*^9}},ExpressionUUID->"5b25d158-ee6d-4638-8de0-\
5b3651053232"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "[", 
   RowBox[{"\[Theta]_", ",", "ni_", ",", "nf_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{"ni", " ", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], "/", "nf"}]}], 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"ni", " ", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "/", "nf"}]}], ")"}], 
      "2"]}]]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "[", 
   RowBox[{"\[Theta]_", ",", "ni_", ",", "nf_", ",", "d_"}], "]"}], ":=", 
  RowBox[{"d", " ", 
   RowBox[{"Tan", "[", "\[Theta]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "[", 
   RowBox[{"\[Phi]_", ",", "\[Theta]_", ",", "ni_", ",", "nf_", ",", "d_"}], 
   "]"}], ":=", 
  FractionBox[
   RowBox[{"b", "[", 
    RowBox[{"\[Theta]", ",", "ni", ",", "nf", ",", "d"}], "]"}], 
   RowBox[{
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "-", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\[Theta]", ",", "ni", ",", "nf"}], "]"}], 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "[", 
   RowBox[{"x_", ",", "\[Theta]_", ",", "ni_", ",", "nf_", ",", "d_"}], "]"}],
   ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"\[Theta]", ",", "ni", ",", "nf"}], "]"}], "x"}], "+", 
   RowBox[{"b", "[", 
    RowBox[{"\[Theta]", ",", "ni", ",", "nf", ",", "d"}], "]"}]}]}]}], "Input",\

 CellChangeTimes->{{3.891612709279779*^9, 3.891612713848607*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"b142235b-8962-495a-a165-532e034c2a47"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Comparisson", "Subsection",
 CellChangeTimes->{
  3.8916118650404654`*^9, {3.891611957898706*^9, 
   3.8916119597327538`*^9}},ExpressionUUID->"e4442799-526a-4e22-a5c1-\
742ba2eafc46"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"nr", " ", "=", " ", 
     RowBox[{"1.515", "/", "1.33"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"getParaxial", "[", "nr", "]"}], ",", 
     RowBox[{"getW4min", "[", "nr", "]"}], ",", 
     RowBox[{"getW6min", "[", "nr", "]"}], ",", 
     RowBox[{"getWmin", "[", "nr", "]"}], ",", 
     RowBox[{"get\[Epsilon]4min", "[", "nr", "]"}], ",", 
     RowBox[{"get\[Epsilon]6min", "[", "nr", "]"}], ",", 
     RowBox[{"getLeastConfusion", "[", 
      RowBox[{
       RowBox[{"1", "/", "nr"}], ",", "nr"}], "]"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.891587533098774*^9, 3.89158759057756*^9}, {
   3.891587906743524*^9, 3.891587912316362*^9}, {3.891588628322069*^9, 
   3.8915886316460447`*^9}, 3.891610045109064*^9, {3.891610704879797*^9, 
   3.891610711044248*^9}, {3.891611901522427*^9, 3.8916119036161623`*^9}, {
   3.8916123989837837`*^9, 3.8916124018598833`*^9}, {3.891665296475322*^9, 
   3.891665308353525*^9}, {3.891666482383236*^9, 3.891666498105629*^9}, {
   3.891668095315209*^9, 3.8916681400051003`*^9}, 3.8916742531688423`*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"7afc98e7-8467-4cd9-8c95-1c11c819cd8a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.139097744360902`", ",", "1.1943444145193585`", ",", "1.233843812855304`",
    ",", "1.395024655268398`", ",", "1.209772380069772`", ",", 
   "1.2710641779602763`", ",", "1.4116668835501693`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.891587624260508*^9, {3.891588157217502*^9, 3.891588161067061*^9}, 
   3.8915886325434723`*^9, 3.891610053555846*^9, 3.891610711821129*^9, 
   3.891610782768936*^9, 3.891611904304574*^9, 3.8916119475940437`*^9, 
   3.891612402417481*^9, 3.8916647628869677`*^9, 3.891665320494257*^9, {
   3.891666488489964*^9, 3.891666498849547*^9}, 3.891668142423064*^9, 
   3.8916742558701787`*^9, 3.8916743102288637`*^9, 3.8919224628237467`*^9, 
   3.8921923531869783`*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"2dad1d7b-e5c9-4d76-b3e9-3b7b67237666"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotRaysInterface", "[", 
   RowBox[{"ni_", ",", "nf_", ",", "na_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dcs", "=", "50"}], ",", 
      RowBox[{"num\[Theta]", "=", "25"}], ",", 
      RowBox[{"\[Alpha]", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nr", ",", 
        RowBox[{"pry", "=", 
         RowBox[{"0.5", "*", "dcs"}]}], ",", "\[Theta]imax", ",", 
        "\[Theta]ilist", ",", "\[Theta]flist", ",", "\[Alpha]par", ",", 
        "\[Alpha]\[Epsilon]list", ",", "prxm", ",", "prxp", ",", "\[Alpha]lc",
         ",", "\[Alpha]Wlist"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nr", " ", "=", " ", 
        RowBox[{"nf", "/", "ni"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"prxm", "=", 
        RowBox[{
         RowBox[{"-", "2.5"}], "dcs"}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{".1", "+", "\[Alpha]"}], ")"}], "nf", " ", 
         RowBox[{"dcs", "/", "ni"}]}], "*)"}], ";", "\[IndentingNewLine]", 
       RowBox[{"prxp", "=", 
        RowBox[{"0.1", "nf", " ", 
         RowBox[{"dcs", "/", "ni"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Theta]imax", "=", 
        RowBox[{"ArcSin", "[", 
         RowBox[{"na", "/", "nf"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Theta]ilist", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"\[Theta]", ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", 
              RowBox[{"-", "\[Theta]imax"}], ",", 
              RowBox[{
               RowBox[{"-", "\[Theta]imax"}], "/", "num\[Theta]"}], ",", 
              RowBox[{"\[Theta]imax", "/", "num\[Theta]"}]}], "}"}]}], "]"}], 
          ",", 
          RowBox[{"Table", "[", 
           RowBox[{"\[Theta]", ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", 
              RowBox[{"\[Theta]imax", "/", "num\[Theta]"}], ",", 
              "\[Theta]imax", ",", 
              RowBox[{"\[Theta]imax", "/", "num\[Theta]"}]}], "}"}]}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Theta]flist", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArcSin", "[", 
           RowBox[{
            FractionBox["ni", "nf"], 
            RowBox[{"Sin", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
         "\[Theta]ilist"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Alpha]lc", " ", "=", 
        RowBox[{"getLeastConfusion", "[", 
         RowBox[{
          RowBox[{"1", "/", "nr"}], ",", "nr"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Alpha]par", "=", 
        RowBox[{"getParaxial", "[", "nr", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Alpha]Wlist", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"getW4min", "[", "nr", "]"}], ",", 
          RowBox[{"getW6min", "[", "nr", "]"}], ",", 
          RowBox[{"getWmin", "[", "nr", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Alpha]\[Epsilon]list", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"get\[Epsilon]4min", "[", "nr", "]"}], ",", 
          RowBox[{"get\[Epsilon]6min", "[", "nr", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Graphics", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Thick", ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "pry"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "pry"}], "}"}]}], "}"}], "]"}]}], "}"}],
                 ",", "\[IndentingNewLine]", "Dotted", ",", 
                RowBox[{"AbsoluteThickness", "[", "1.2", "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "dcs"}], ",", 
                    RowBox[{"-", "pry"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "dcs"}], ",", "pry"}], "}"}]}], "}"}], "]"}],
                 ",", "\[IndentingNewLine]", "DotDashed", ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[Alpha]par"}], " ", "dcs"}], ",", 
                    RowBox[{"-", "pry"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[Alpha]par"}], " ", "dcs"}], ",", "pry"}], 
                    "}"}]}], "}"}], "]"}], ",", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[Alpha]derW"}], " ", "dcs"}], ",", 
                    RowBox[{"-", "pry"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[Alpha]derW"}], " ", "dcs"}], ",", "pry"}],
                     "}"}]}], "}"}], "]"}], ","}], "*)"}], 
                "\[IndentingNewLine]", "Dashed", ",", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{"LEast", " ", "confusion"}], "*)"}], 
                "\[IndentingNewLine]", "Magenta", ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[Alpha]lc"}], " ", "dcs"}], ",", 
                    RowBox[{"-", "pry"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[Alpha]lc"}], " ", "dcs"}], ",", "pry"}], 
                    "}"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{"Wavefront", " ", "focuses"}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Darker", "[", 
                    RowBox[{
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.", ",", "0.69", ",", "1."}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "/", "4"}]}], "]"}], ",", 
                    
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Alpha]Wlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "dcs"}], ",", 
                    RowBox[{"-", "pry"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Alpha]Wlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], " ", "dcs"}], ",", 
                    "pry"}], "}"}]}], "}"}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{"Spot", " ", "size"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Darker", "[", 
                    RowBox[{
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.9", ",", "0.54", ",", "0."}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "/", "4"}]}], "]"}], ",", 
                    
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Alpha]\[Epsilon]list", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "dcs"}], ",", 
                    RowBox[{"-", "pry"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Alpha]\[Epsilon]list", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], " ", "dcs"}], ",", 
                    "pry"}], "}"}]}], "}"}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}]}], "}"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Source", " ", "rays"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"Blue", ",", "Thin", ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "dcs"}], ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "dcs"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"dcs", " ", 
                    RowBox[{"Tan", "[", "#", "]"}]}]}], "}"}]}], "}"}], "]"}],
                   "&"}], "/@", "\[Theta]ilist"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Refracted", " ", "rays"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Hue", "[", 
                 RowBox[{"0.88", ",", "1.", ",", "0.65"}], "]"}], ",", " ", 
                "Thin", ",", " ", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"prxm", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"prxp", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"prxm", ",", 
                    RowBox[{"y", "[", 
                    RowBox[{
                    "prxm", ",", "#", ",", "ni", ",", "nf", ",", "dcs"}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"prxp", ",", 
                    RowBox[{"y", "[", 
                    RowBox[{
                    "prxp", ",", "#", ",", "ni", ",", "nf", ",", "dcs"}], 
                    "]"}]}], "}"}]}], "}"}], "]"}], "&"}], "/@", 
                 "\[Theta]ilist"}]}], "}"}]}], "}"}], "\[IndentingNewLine]", 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", "Caustic", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"ParametricPlot", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                FractionBox[
                 RowBox[{
                  RowBox[{"-", "dcs"}], " ", "nf"}], "ni"], 
                SuperscriptBox[
                 RowBox[{"Cosh", "[", "\[Theta]", "]"}], "3"]}], ",", 
               RowBox[{
                FractionBox[
                 RowBox[{"dcs", " ", "nf"}], 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox["nf", "2"], "-", 
                   SuperscriptBox["ni", "2"]}]]], 
                SuperscriptBox[
                 RowBox[{"Sinh", "[", "\[Theta]", "]"}], "3"]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]", ",", 
               RowBox[{
                RowBox[{"-", "\[Pi]"}], "/", "2"}], ",", 
               RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"Red", ",", "Thick"}], "}"}]}]}], "]"}]}], "}"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"prxm", ",", "prxp"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "pry"}], ",", "pry"}], "}"}]}], "}"}]}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8916127677470217`*^9, 3.8916128654088306`*^9}, {
   3.8916129406052713`*^9, 3.8916130114715567`*^9}, {3.891667096848308*^9, 
   3.891667102199148*^9}, {3.891667149561604*^9, 3.891667171310954*^9}, {
   3.891667210085889*^9, 3.891667218766089*^9}, {3.891668415354864*^9, 
   3.8916684607157383`*^9}, {3.8916687507835913`*^9, 3.891668786571886*^9}, {
   3.8916688593141003`*^9, 3.8916690596643667`*^9}, 3.891669109029443*^9, {
   3.891669155375828*^9, 3.891669156354622*^9}, {3.891669187741592*^9, 
   3.8916691960470324`*^9}, {3.89166923510981*^9, 3.891669250456623*^9}, {
   3.8916693011979923`*^9, 3.891669303014583*^9}, {3.8916693437956867`*^9, 
   3.891669438153973*^9}, {3.8916694907391577`*^9, 3.8916696637292767`*^9}, {
   3.891669829520404*^9, 3.891669855932665*^9}, 3.891674250523918*^9, {
   3.8916809675659213`*^9, 3.891681009155408*^9}, {3.8916810481550584`*^9, 
   3.8916810732540445`*^9}, 3.891681117594802*^9, {3.892192406180768*^9, 
   3.892192432741728*^9}, {3.892192565468749*^9, 3.892192597028037*^9}, {
   3.892192628018922*^9, 3.892192636407365*^9}, {3.892192796145772*^9, 
   3.892192796752548*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"89d5599d-cd68-427b-891b-fa0f52a3a4f6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"savePath", " ", "=", " ", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<figures\>\"", ",", 
     "\"\<best_focus\>\""}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8916813281826134`*^9, 3.891681332536542*^9}, {
   3.891681374500672*^9, 3.8916813795727844`*^9}, {3.8916814718944387`*^9, 
   3.891681511885998*^9}, 3.892192880316018*^9},
 CellLabel->"In[33]:=",ExpressionUUID->"cf9ade2b-92f7-4145-8a4c-f48c75d920ab"],

Cell[BoxData["\<\"/Users/rodrigo/Documents/Research/CHIDO/pyPSFstack/figures/\
best_focus\"\>"], "Output",
 CellChangeTimes->{
  3.8916813329427805`*^9, 3.8916813807740135`*^9, {3.8916815003671365`*^9, 
   3.8916815125175467`*^9}, 3.891922467805179*^9, 3.892192885938609*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"9df4fad1-8dc5-4d1e-a7c2-6d56cb7a7d01"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"plotRaysInterface", "[", 
  RowBox[{"1.33", ",", "1.515", ",", "1.33"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"savePath", " ", ",", "\"\<IntWaterOil.pdf\>\""}], "}"}], "]"}], 
   ",", "%"}], "]"}]}], "Input",
 CellChangeTimes->{{3.891681097279011*^9, 3.8916811109603014`*^9}, {
  3.8916812014265304`*^9, 3.891681249717989*^9}, {3.8916815232789555`*^9, 
  3.8916815377220745`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"5ba6ca9b-1cc6-4c9a-b10d-8dc8dec51970"],

Cell[BoxData[
 GraphicsBox[{{{
     {Thickness[Large], LineBox[{{0, -25.}, {0, 25.}}]}, 
     {AbsoluteThickness[1.2], Dashing[{0, Small}], 
      LineBox[{{-50, -25.}, {-50, 25.}}], 
      {Dashing[{0, Small, Small, Small}], 
       LineBox[{{-56.9548872180451, -25.}, {-56.9548872180451, 25.}}]}, 
      {RGBColor[1, 0, 1], Dashing[{Small, Small}], 
       LineBox[{{-70.58334417750847, -25.}, {-70.58334417750847, 25.}}], {
        {RGBColor[0., 0.69, 1.], 
         LineBox[{{-59.71722072596792, -25.}, {-59.71722072596792, 25.}}]}, 
        {RGBColor[0., 0.5175, 0.75], 
         LineBox[{{-61.6921906427652, -25.}, {-61.6921906427652, 25.}}]}, 
        {RGBColor[0., 0.345, 0.5], 
         LineBox[{{-69.7512327634199, -25.}, {-69.7512327634199, 25.}}]}}, {
        {RGBColor[0.9, 0.54, 0.], 
         LineBox[{{-60.488619003488594`, -25.}, {-60.488619003488594`, 
          25.}}]}, 
        {RGBColor[0.675, 0.405, 0.], 
         LineBox[{{-63.553208898013814`, -25.}, {-63.553208898013814`, 
          25.}}]}}}}}, 
    {RGBColor[0, 0, 1], Thickness[Tiny], 
     LineBox[{{-50, 0}, {0, 0}}], {
      LineBox[{{-50, 0}, {0, -91.66312215259012}}], 
      LineBox[{{-50, 0}, {0, -82.9941976486229}}], 
      LineBox[{{-50, 0}, {0, -75.47740165901844}}], 
      LineBox[{{-50, 0}, {0, -68.8746334416352}}], 
      LineBox[{{-50, 0}, {0, -63.00843024082998}}], 
      LineBox[{{-50, 0}, {0, -57.74374637872408}}], 
      LineBox[{{-50, 0}, {0, -52.97592424228449}}], 
      LineBox[{{-50, 0}, {0, -48.62253317634038}}], 
      LineBox[{{-50, 0}, {0, -44.617698336293465`}}], 
      LineBox[{{-50, 0}, {0, -40.90807530956356}}], 
      LineBox[{{-50, 0}, {0, -37.44993819899983}}], 
      LineBox[{{-50, 0}, {0, -34.207036822462875`}}], 
      LineBox[{{-50, 0}, {0, -31.14899511445037}}], 
      LineBox[{{-50, 0}, {0, -28.25009673270434}}], 
      LineBox[{{-50, 0}, {0, -25.488351847524804`}}], 
      LineBox[{{-50, 0}, {0, -22.844770856120384`}}], 
      LineBox[{{-50, 0}, {0, -20.302792178972272`}}], 
      LineBox[{{-50, 0}, {0, -17.84782596975406}}], 
      LineBox[{{-50, 0}, {0, -15.466885774950633`}}], 
      LineBox[{{-50, 0}, {0, -13.14828736865411}}], 
      LineBox[{{-50, 0}, {0, -10.881399110304336`}}], 
      LineBox[{{-50, 0}, {0, -8.656431856006641}}], 
      LineBox[{{-50, 0}, {0, -6.464259118499589}}], 
      LineBox[{{-50, 0}, {0, -4.296260102355464}}], 
      LineBox[{{-50, 0}, {0, -2.144179634595676}}], 
      LineBox[{{-50, 0}, {0, 2.144179634595673}}], 
      LineBox[{{-50, 0}, {0, 4.2962601023554585`}}], 
      LineBox[{{-50, 0}, {0, 6.464259118499586}}], 
      LineBox[{{-50, 0}, {0, 8.656431856006641}}], 
      LineBox[{{-50, 0}, {0, 10.881399110304333`}}], 
      LineBox[{{-50, 0}, {0, 13.148287368654104`}}], 
      LineBox[{{-50, 0}, {0, 15.466885774950631`}}], 
      LineBox[{{-50, 0}, {0, 17.84782596975406}}], 
      LineBox[{{-50, 0}, {0, 20.302792178972272`}}], 
      LineBox[{{-50, 0}, {0, 22.844770856120377`}}], 
      LineBox[{{-50, 0}, {0, 25.488351847524804`}}], 
      LineBox[{{-50, 0}, {0, 28.25009673270434}}], 
      LineBox[{{-50, 0}, {0, 31.14899511445037}}], 
      LineBox[{{-50, 0}, {0, 34.207036822462875`}}], 
      LineBox[{{-50, 0}, {0, 37.449938198999824`}}], 
      LineBox[{{-50, 0}, {0, 40.90807530956356}}], 
      LineBox[{{-50, 0}, {0, 44.617698336293465`}}], 
      LineBox[{{-50, 0}, {0, 48.62253317634038}}], 
      LineBox[{{-50, 0}, {0, 52.97592424228449}}], 
      LineBox[{{-50, 0}, {0, 57.74374637872408}}], 
      LineBox[{{-50, 0}, {0, 63.00843024082998}}], 
      LineBox[{{-50, 0}, {0, 68.8746334416352}}], 
      LineBox[{{-50, 0}, {0, 75.47740165901844}}], 
      LineBox[{{-50, 0}, {0, 82.9941976486229}}], 
      LineBox[{{-50, 0}, {0, 91.66312215259012}}]}}, 
    {Hue[0.88, 1., 0.65], Thickness[Tiny], 
     LineBox[{{-125., 0}, {5.6954887218045105`, 0}}], {
      LineBox[{{-125., 59.51981095377835}, {
       5.6954887218045105`, -98.5516076760833}}], 
      LineBox[{{-125., 59.59689582326439}, {
       5.6954887218045105`, -89.49120536621416}}], 
      LineBox[{{-125., 58.77160350227503}, {
       5.6954887218045105`, -81.59431121749542}}], 
      LineBox[{{-125., 57.30651319575502}, {
       5.6954887218045105`, -74.62393982225613}}], 
      LineBox[{{-125., 55.38997377614645}, {
       5.6954887218045105`, -68.40312443889673}}], 
      LineBox[{{-125., 53.15802431953905}, {
       5.6954887218045105`, -62.79686465264494}}], 
      LineBox[{{-125., 50.709334695934714`}, {
       5.6954887218045105`, -57.70023002548456}}], 
      LineBox[{{-125., 48.11559446943009}, {
       5.6954887218045105`, -53.03030049614015}}], 
      LineBox[{{-125., 45.42884925687746}, {
       5.6954887218045105`, -48.72057110632817}}], 
      LineBox[{{-125., 42.68674489917068}, {
       5.6954887218045105`, -44.71698215516453}}], 
      LineBox[{{-125., 39.9163130457424}, {
       5.6954887218045105`, -40.97504709030162}}], 
      LineBox[{{-125., 37.13672601728528}, {
       5.6954887218045105`, -37.45773759546193}}], 
      LineBox[{{-125., 34.3613152473914}, {
       5.6954887218045105`, -34.133900985072636`}}], 
      LineBox[{{-125., 31.59905873746995}, {
       5.6954887218045105`, -30.977058252623557`}}], 
      LineBox[{{-125., 28.855682662307935`}, {
       5.6954887218045105`, -27.964478532709663`}}], 
      LineBox[{{-125., 26.13448070349086}, {
       5.6954887218045105`, -25.076457055001917`}}], 
      LineBox[{{-125., 23.43692567498459}, {
       5.6954887218045105`, -22.295744736829253`}}], 
      LineBox[{{-125., 20.763127538042024`}, {
       5.6954887218045105`, -19.607091971688227`}}], 
      LineBox[{{-125., 18.112177337661592`}, {
       5.6954887218045105`, -16.99687917692379}}], 
      LineBox[{{-125., 15.482406152715392`}, {
       5.6954887218045105`, -14.452813705041322`}}], 
      LineBox[{{-125., 12.871580624611966`}, {
       5.6954887218045105`, -11.963677735820072`}}], 
      LineBox[{{-125., 10.277051179206815`}, {
       5.6954887218045105`, -9.519115368738923}}], 
      LineBox[{{-125., 7.695865102307318}, {
       5.6954887218045105`, -7.109449740891242}}], 
      LineBox[{{-125., 5.124853763823663}, {
       5.6954887218045105`, -4.725522884528738}}], 
      LineBox[{{-125., 2.5607012242064027`}, {
       5.6954887218045105`, -2.358552401545605}}], 
      LineBox[{{-125., -2.5607012242064}, {5.6954887218045105`, 
       2.358552401545602}}], 
      LineBox[{{-125., -5.124853763823656}, {5.6954887218045105`, 
       4.725522884528733}}], 
      LineBox[{{-125., -7.695865102307315}, {5.6954887218045105`, 
       7.109449740891239}}], 
      LineBox[{{-125., -10.277051179206815`}, {5.6954887218045105`, 
       9.519115368738923}}], 
      LineBox[{{-125., -12.871580624611962`}, {5.6954887218045105`, 
       11.963677735820067`}}], 
      LineBox[{{-125., -15.482406152715386`}, {5.6954887218045105`, 
       14.452813705041315`}}], 
      LineBox[{{-125., -18.112177337661592`}, {5.6954887218045105`, 
       16.99687917692379}}], 
      LineBox[{{-125., -20.763127538042024`}, {5.6954887218045105`, 
       19.607091971688227`}}], 
      LineBox[{{-125., -23.43692567498459}, {5.6954887218045105`, 
       22.295744736829253`}}], 
      LineBox[{{-125., -26.13448070349083}, {5.6954887218045105`, 
       25.07645705500191}}], 
      LineBox[{{-125., -28.85568266230792}, {5.6954887218045105`, 
       27.964478532709663`}}], 
      LineBox[{{-125., -31.59905873746995}, {5.6954887218045105`, 
       30.977058252623557`}}], 
      LineBox[{{-125., -34.3613152473914}, {5.6954887218045105`, 
       34.133900985072636`}}], 
      LineBox[{{-125., -37.13672601728528}, {5.6954887218045105`, 
       37.45773759546193}}], 
      LineBox[{{-125., -39.916313045742406`}, {5.6954887218045105`, 
       40.975047090301615`}}], 
      LineBox[{{-125., -42.68674489917068}, {5.6954887218045105`, 
       44.71698215516453}}], 
      LineBox[{{-125., -45.42884925687746}, {5.6954887218045105`, 
       48.72057110632817}}], 
      LineBox[{{-125., -48.11559446943009}, {5.6954887218045105`, 
       53.03030049614015}}], 
      LineBox[{{-125., -50.709334695934714`}, {5.6954887218045105`, 
       57.70023002548456}}], 
      LineBox[{{-125., -53.15802431953905}, {5.6954887218045105`, 
       62.79686465264494}}], 
      LineBox[{{-125., -55.38997377614645}, {5.6954887218045105`, 
       68.40312443889673}}], 
      LineBox[{{-125., -57.30651319575502}, {5.6954887218045105`, 
       74.62393982225613}}], 
      LineBox[{{-125., -58.77160350227503}, {5.6954887218045105`, 
       81.59431121749542}}], 
      LineBox[{{-125., -59.59689582326439}, {5.6954887218045105`, 
       89.49120536621416}}], 
      LineBox[{{-125., -59.51981095377835}, {5.6954887218045105`, 
       98.5516076760833}}]}}}, {{{}, {}, 
     TagBox[
      {RGBColor[1, 0, 0], Thickness[Large], Opacity[1.], FaceForm[Opacity[
       0.3]], LineBox[CompressedData["
1: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
SBWZ0k+y2ujTkO6ZjZTtZ44Jli2qIc1usRfdQQQo8MvKxz9RQmM+ezXSKaMT
lpmTNpuRV9StGmfKKc4Dq6QypFEWp6irCuUibmMkJSaGlrjiFZcvUfk6KF4T
8EMYnX41w91JOUNvyL1UdRXam63P/oiyS5/1XmVyufaAlKVEAuVZHf4XpRt+
17I+bjW7QDl/aybvR4+h2pTssjRHyqLPlSdlRN/XrnWZ4CQpoz9qSaxcVCum
9I6xl3JAVE5ihHF27fxW8+36lAUMt9qUHHWrNa84M6pHWWHRofTAYUkaG6Hy
Yg/lnJXiZEGeWJpiFKPcmPLeHc6L5/1Kaeqb4uptKN8ld+ywNW6iIY4dUycp
++8v7nhv30/rUb+2K4xylfpl21f547Ty9nsZtygfmFoZzLKeo83tuCIFlNnr
fYWztDmwyMZd5SOU7acmXUba+LGn8u8911H79eih9dXAYRHMeM6DZkx58Yz6
WHS5JOayabVqCOW45Tb1OytyWOXt97pVlAWn1J4UTCpgIYm9Tn8pW7K926lZ
tx0z4F3HEU/Vz8Y+3zVWWQdrjYgI7aOc1K3GE5euh6nbF4hrUXng3T179mI2
DdufWpr9g3J5qbbBZ5P92JE1A4mWVJ4WA8ppVfWm2FpB99s1lIlnhUIu2QRm
aiojkkXlcfPgY/fdyAo7VfM4QILK7+6nR61j9h/CCjYeXb5BWTeKS/IUpy32
N/epSy6VdweV9lApdSesoPBf5gLVLzv//ftuVHcCG/KvWi6g+snAMPBfmu4p
bN409oRzFAFj12vYUz56YvHerZafo6m8zz3j39Z2DutOZ6UpUP377SyjXQz5
YyPJ5/avYhIQban2zP1ZIJbYf2XpB+VbfzKyPLqCMLdt0gktVwmY4GQeqVUL
w9x/6BLvqfkRI/EtbK93FCY5Ouw0TM2XKI10WYHhaCyULApbYhGQ/jZpe453
LDaf+2DagJpHDvvyJJ88ZmJc2J68VRlU3jRnfJyYSdh/bxpant+j1heJloSW
dIwrkUdCI4+Abf0bJAiFTMzxtXNwfj6V59aoXzsZt7DAv6asBw+o+VedIjmj
l41ldCwKLZYSEFSiI/LXKxdTTNScRIiAn4uGZ635HmAK9PvbUl4QMEjTKm3a
UITZG+kxz9QRYKpse+68zkNsbq/7S50GArwDZNY8Ci3G6h01Ngu1Uu/NnN69
0nmMpXmeZ458pvIarPSD6+tTLMOjLXZ+gIAyH4+N3zIrsaqYyQmhIWq+aDYs
JtpXYfWjggtmowR4OJ3I9hyqxuRjfWV4pghw6zKeMlOoxZJTnSMjOElI1yiS
olW8xBSgNGSMm4Q9l+ocbXbUYZuS9CeP8JIQPDj5NKusDrMuVTY0EiTh1WTB
xPeaV1h4kOlTe3ESXHMIp57h19jZFYX+FOp8bSocfJT1oBkrfnG730adhL3H
EnxPmbdgfUjRQ0qLhNzk6LGq2Rbs9ZSqXIUuCdPMwnDOg+8w5wl5moYRCV9a
rf8MxbZhmUYjBzSo875v6enzw0mdWOls11ePayS42+gK6z/twRLenlxQZJHA
HrJO9sjeXiyiwezV+A0S8sj/pi3f9mI3/z0JZdwmYWXfz9SpsT6sVMbr2fpH
JAzf1fq4a89nTHb7OqkL70g4Jbz2t5/cV+yN2AS/xTo61DSf0H4wMYKJRP/K
HZWgw+1fRZ0ch0Yx6XmaTqw0dT/LURwPfzaK8YDOwT5FOrgpmFcsJ3zHnn+l
h3XrUfeniMjTMobjmEDCFWyzCx3mYSE08+sEtrpxql+0nA5sVndLn8dPY9jy
7ZyL1XRI2LCd77+Oaaw2wP/MF0SHUaNYpyzJGcx++YhiYxMdFIISczUKZrBf
gU7Hf32hg5W5l9jltlms9jZ17AqZw2DRlFIaPo+tq0qfw86ag9vitTGTh8vY
d7sReuBmCzDtZg/T8+fGV477vu9WtICft6dLLIu58cN+x5H+NgvQ8c3Y3TrC
jWfK0ZoFNC0gbIsY35LdKrxpxnzoPc0CLs0f9Fcy4sE/jjV5rra3gOX7P2NU
lPlwlpXmnQ3U/bv4pdLkT2NB/MyRL6fFxC3Bwlr4+4HzoviXo3dZgW5WsOB5
ZEyoTg6nf3spNzlsDeVNG8aqJbbh0eOmKztKDsGWqScivDRtXLU/bcmX3xZk
ybeVj3UM8Po2CyZbyVGQuCO+Z/q6Ea7JEKmV2uIEbON6F5v3m+F/Vy7yHeRw
AZPerLQnu63w2fauaXZjV+BbHAltHjiCG/HI0vx0T0Cm3y8N/PoxPD7LsyQn
4hTwnMyoUTV1w19MSqbgLd5gq/C9Zo3taVxH3ldB6/x5uHlPPEBu8Bzu0LPK
JfGAL1w0fRadreSHX1RZt9y04g+BJZ8f5fRdwlddzXzuqBwMMpOyd3eXheEO
4kiQHhUGa7T0s7wyruDdVv++O5dFwv5t3KONbxi4rcRlG2vTGLjN96e5vfga
bvQqMKDVLgb2cBR2dbdcwy8E2ZbZecbAxLmL/fPfr+HZJ5bupCbEgKJSqrSh
SCLuteVa+ouuGOi8NklzJxPx2NRt9KYTseDa/G9E9HUirmjPpyGQwgD9z+pe
x14k4UrFN7xd8hiQhjEaY9qTcNvrD0waqhmwUB60qnYgCVcVfMj1coAB8dmP
SBuOZPz8HiUBP404qBxYsVXel4zz7eeq6GuLg3e5PC8uNyXjAqodnVrDcfDQ
JzKL2ZuM28oLOKctxMHGj2Ib7/9Ixk3WVyzclGfCx4/hcjzCLPxcsfIjBz8m
TGuzii/ZsHA7PoMa3TgmFB4q/rjkzsKPyb3N3ZzFBJm8UbYEfxa+O7GFptbI
hMbdf2P701n4bRFeQfITE/4dWcOeWcTCrSsdJoKnmeDkhYpO1bJww+G3k895
4+FNBaQat7Hw//f/j/8PTtAgfg==
        "]]},
      Annotation[#, "Charting`Private`Tag$19323#1"]& ]}, {}}},
  PlotRange->{{-125., 5.6954887218045105`}, {-25., 25.}}]], "Output",
 CellChangeTimes->{
  3.891680848377039*^9, 3.891680973902427*^9, 3.891681011910595*^9, 
   3.8916811243244123`*^9, 3.8916812508543987`*^9, 3.8916815399445333`*^9, 
   3.891922470283042*^9, {3.8921928881896753`*^9, 3.892192904374546*^9}},
 CellLabel->"Out[40]=",ExpressionUUID->"4bff6731-ee2d-4711-80e2-97f2e94b1e04"],

Cell[BoxData["\<\"/Users/rodrigo/Documents/Research/CHIDO/pyPSFstack/figures/\
best_focus/IntWaterOil.pdf\"\>"], "Output",
 CellChangeTimes->{
  3.891680848377039*^9, 3.891680973902427*^9, 3.891681011910595*^9, 
   3.8916811243244123`*^9, 3.8916812508543987`*^9, 3.8916815399445333`*^9, 
   3.891922470283042*^9, {3.8921928881896753`*^9, 3.8921929045834303`*^9}},
 CellLabel->"Out[41]=",ExpressionUUID->"1715bdb8-ee00-4e0f-9f6f-79d2dd372441"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"nr", " ", "=", " ", 
     RowBox[{"1.515", "/", "1.33"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"getParaxial", "[", "nr", "]"}], ",", 
     RowBox[{"getW4min", "[", "nr", "]"}], ",", 
     RowBox[{"getW6min", "[", "nr", "]"}], ",", 
     RowBox[{"getWmin", "[", "nr", "]"}], ",", 
     RowBox[{"get\[Epsilon]4min", "[", "nr", "]"}], ",", 
     RowBox[{"get\[Epsilon]6min", "[", "nr", "]"}], ",", 
     RowBox[{"getLeastConfusion", "[", 
      RowBox[{
       RowBox[{"1", "/", "nr"}], ",", "nr"}], "]"}]}], "}"}]}], 
  "]"}]], "Input",
 CellLabel->
  "In[277]:=",ExpressionUUID->"56f97bdd-d924-4d11-acd9-757238c1ab38"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.139097744360902`", ",", "1.1943444145193585`", ",", "1.233843812855304`",
    ",", "1.395024655268398`", ",", "1.209772380069772`", ",", 
   "1.2710641779602763`", ",", "1.4116668835501693`"}], "}"}]], "Output",
 CellChangeTimes->{3.8919234398487186`*^9},
 CellLabel->
  "Out[277]=",ExpressionUUID->"41a65c01-ea3d-40f0-93ac-539e12935d1f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"plotRaysInterface", "[", 
  RowBox[{"1.", ",", "1.515", ",", "1."}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"savePath", " ", ",", "\"\<IntAirOil.pdf\>\""}], "}"}], "]"}], 
   ",", "%"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8916811678262672`*^9, 3.8916811709447627`*^9}, {
  3.8916815479912148`*^9, 3.891681554532051*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"1311847e-f1a2-4cb4-8c96-4559d0d3d1e4"],

Cell[BoxData[
 GraphicsBox[{{{
     {Thickness[Large], LineBox[{{0, -25.}, {0, 25.}}]}, 
     {AbsoluteThickness[1.2], Dashing[{0, Small}], 
      LineBox[{{-50, -25.}, {-50, 25.}}], 
      {Dashing[{0, Small, Small, Small}], 
       LineBox[{{-75.75, -25.}, {-75.75, 25.}}]}, 
      {RGBColor[1, 0, 1], Dashing[{Small, Small}], 
       LineBox[{{-86.75811222103108, -25.}, {-86.75811222103108, 25.}}], {
        {RGBColor[0., 0.69, 1.], 
         LineBox[{{-85.44386622893968, -25.}, {-85.44386622893968, 25.}}]}, 
        {RGBColor[0., 0.5175, 0.75], 
         LineBox[{{-91.46417948654718, -25.}, {-91.46417948654718, 25.}}]}, 
        {RGBColor[0., 0.345, 0.5], 
         LineBox[{{-107.1485652907044, -25.}, {-107.1485652907044, 
          25.}}]}}, {
        {RGBColor[0.9, 0.54, 0.], 
         LineBox[{{-88.3638334207804, -25.}, {-88.3638334207804, 25.}}]}, 
        {RGBColor[0.675, 0.405, 0.], 
         LineBox[{{-98.07568730794594, -25.}, {-98.07568730794594, 
          25.}}]}}}}}, 
    {RGBColor[0, 0, 1], Thickness[Tiny], 
     LineBox[{{-50, 0}, {0, 0}}], {
      LineBox[{{-50, 0}, {0, -43.93366105135426}}], 
      LineBox[{{-50, 0}, {0, -41.441135741177966`}}], 
      LineBox[{{-50, 0}, {0, -39.06500432746067}}], 
      LineBox[{{-50, 0}, {0, -36.7936096688596}}], 
      LineBox[{{-50, 0}, {0, -34.616634720805706`}}], 
      LineBox[{{-50, 0}, {0, -32.52490505480626}}], 
      LineBox[{{-50, 0}, {0, -30.510224524313124`}}], 
      LineBox[{{-50, 0}, {0, -28.56523769208289}}], 
      LineBox[{{-50, 0}, {0, -26.683313994506246`}}], 
      LineBox[{{-50, 0}, {0, -24.858449660340156`}}], 
      LineBox[{{-50, 0}, {0, -23.08518420530629}}], 
      LineBox[{{-50, 0}, {0, -21.358528948858044`}}], 
      LineBox[{{-50, 0}, {0, -19.673905488215045`}}], 
      LineBox[{{-50, 0}, {0, -18.027092449483554`}}], 
      LineBox[{{-50, 0}, {0, -16.41417914018899}}], 
      LineBox[{{-50, 0}, {0, -14.831524969793385`}}], 
      LineBox[{{-50, 0}, {0, -13.275723698349505`}}], 
      LineBox[{{-50, 0}, {0, -11.743571728713825`}}], 
      LineBox[{{-50, 0}, {0, -10.23203978264131}}], 
      LineBox[{{-50, 0}, {0, -8.738247401730161}}], 
      LineBox[{{-50, 0}, {0, -7.259439795301869}}], 
      LineBox[{{-50, 0}, {0, -5.7929666225552285`}}], 
      LineBox[{{-50, 0}, {0, -4.336262348566149}}], 
      LineBox[{{-50, 0}, {0, -2.886827855119225}}], 
      LineBox[{{-50, 0}, {0, -1.4422130196464216`}}], 
      LineBox[{{-50, 0}, {0, 1.4422130196464207`}}], 
      LineBox[{{-50, 0}, {0, 2.8868278551192237`}}], 
      LineBox[{{-50, 0}, {0, 4.3362623485661524`}}], 
      LineBox[{{-50, 0}, {0, 5.792966622555231}}], 
      LineBox[{{-50, 0}, {0, 7.259439795301871}}], 
      LineBox[{{-50, 0}, {0, 8.738247401730161}}], 
      LineBox[{{-50, 0}, {0, 10.232039782641309`}}], 
      LineBox[{{-50, 0}, {0, 11.743571728713826`}}], 
      LineBox[{{-50, 0}, {0, 13.275723698349505`}}], 
      LineBox[{{-50, 0}, {0, 14.831524969793385`}}], 
      LineBox[{{-50, 0}, {0, 16.414179140188992`}}], 
      LineBox[{{-50, 0}, {0, 18.027092449483558`}}], 
      LineBox[{{-50, 0}, {0, 19.673905488215045`}}], 
      LineBox[{{-50, 0}, {0, 21.358528948858048`}}], 
      LineBox[{{-50, 0}, {0, 23.085184205306295`}}], 
      LineBox[{{-50, 0}, {0, 24.858449660340156`}}], 
      LineBox[{{-50, 0}, {0, 26.683313994506257`}}], 
      LineBox[{{-50, 0}, {0, 28.56523769208289}}], 
      LineBox[{{-50, 0}, {0, 30.510224524313124`}}], 
      LineBox[{{-50, 0}, {0, 32.52490505480626}}], 
      LineBox[{{-50, 0}, {0, 34.616634720805706`}}], 
      LineBox[{{-50, 0}, {0, 36.793609668859624`}}], 
      LineBox[{{-50, 0}, {0, 39.06500432746068}}], 
      LineBox[{{-50, 0}, {0, 41.441135741177966`}}], 
      LineBox[{{-50, 0}, {0, 43.93366105135426}}]}}, 
    {Hue[0.88, 1., 0.65], Thickness[Tiny], 
     LineBox[{{-125., 0}, {7.575, 0}}], {
      LineBox[{{-125., 16.571840717705193`}, {7.575, -47.60029445855926}}], 
      LineBox[{{-125., 16.611049523224892`}, {7.575, -44.95909816820078}}], 
      LineBox[{{-125., 16.530432212108686`}, {7.575, -42.43408778175857}}], 
      LineBox[{{-125., 16.34351500630462}, {7.575, -40.01371942417455}}], 
      LineBox[{{-125., 16.06221672655471}, {7.575, -37.68777311851575}}], 
      LineBox[{{-125., 15.697066729459806`}, {7.575, -35.44715654493278}}], 
      LineBox[{{-125., 15.257389105783872`}, {7.575, -33.283741910297}}], 
      LineBox[{{-125., 14.75145935130135}, {7.575, -31.190229532911975`}}], 
      LineBox[{{-125., 14.186638411942749`}, {7.575, -29.160033110337054`}}], 
      LineBox[{{-125., 13.569488005973646`}, {7.575, -27.187182682918774`}}], 
      LineBox[{{-125., 12.905870357500277`}, {7.575, -25.266242111812367`}}], 
      LineBox[{{-125., 12.201034879787507`}, {7.575, -23.392238516873967`}}], 
      LineBox[{{-125., 11.459693881371173`}, {7.575, -21.560601610011968`}}], 
      LineBox[{{-125., 10.686089001578932`}, {7.575, -19.76711124541794}}], 
      LineBox[{{-125., 9.884049791734355}, {7.575, -18.007851813463542`}}], 
      LineBox[{{-125., 9.057045626750714}, {7.575, -16.27917234794396}}], 
      LineBox[{{-125., 8.20823194605741}, {7.575, -14.577651410400565`}}], 
      LineBox[{{-125., 7.340491673038272}, {7.575, -12.900065970860002`}}], 
      LineBox[{{-125., 6.4564725409407675`}, {7.575, -11.243363629450384`}}], 
      LineBox[{{-125., 5.558620954839416}, {7.575, -9.604637624138277}}], 
      LineBox[{{-125., 4.649212939330646}, {7.575, -7.9811041510206}}], 
      LineBox[{{-125., 3.7303826568311305`}, {7.575, -6.370081588886042}}], 
      LineBox[{{-125., 2.8041489290481314`}, {7.575, -4.7689712719895745`}}], 
      LineBox[{{-125., 1.8724401523882253`}, {7.575, -3.1752394963741764`}}], 
      LineBox[{{-125., 0.9371179652352435}, {7.575, -1.5864004773302505`}}], 
      LineBox[{{-125., -0.937117965235243}, {7.575, 1.5864004773302496`}}], 
      LineBox[{{-125., -1.872440152388223}, {7.575, 3.175239496374175}}], 
      LineBox[{{-125., -2.8041489290481323`}, {7.575, 4.768971271989578}}], 
      LineBox[{{-125., -3.7303826568311296`}, {7.575, 6.370081588886045}}], 
      LineBox[{{-125., -4.649212939330647}, {7.575, 7.9811041510206016`}}], 
      LineBox[{{-125., -5.558620954839416}, {7.575, 9.604637624138277}}], 
      LineBox[{{-125., -6.456472540940769}, {7.575, 11.243363629450382`}}], 
      LineBox[{{-125., -7.3404916730382705`}, {7.575, 12.900065970860004`}}], 
      LineBox[{{-125., -8.20823194605741}, {7.575, 14.577651410400565`}}], 
      LineBox[{{-125., -9.057045626750714}, {7.575, 16.27917234794396}}], 
      LineBox[{{-125., -9.884049791734359}, {7.575, 18.007851813463546`}}], 
      LineBox[{{-125., -10.686089001578935`}, {7.575, 19.767111245417944`}}], 
      LineBox[{{-125., -11.459693881371173`}, {7.575, 21.560601610011968`}}], 
      LineBox[{{-125., -12.20103487978751}, {7.575, 23.392238516873967`}}], 
      LineBox[{{-125., -12.905870357500273`}, {7.575, 25.26624211181237}}], 
      LineBox[{{-125., -13.569488005973646`}, {7.575, 27.187182682918774`}}], 
      LineBox[{{-125., -14.186638411942745`}, {7.575, 29.160033110337068`}}], 
      LineBox[{{-125., -14.75145935130135}, {7.575, 31.190229532911975`}}], 
      LineBox[{{-125., -15.257389105783872`}, {7.575, 33.283741910297}}], 
      LineBox[{{-125., -15.697066729459806`}, {7.575, 35.44715654493278}}], 
      LineBox[{{-125., -16.06221672655471}, {7.575, 37.68777311851575}}], 
      LineBox[{{-125., -16.343515006304614`}, {7.575, 40.013719424174575`}}], 
      LineBox[{{-125., -16.530432212108686`}, {7.575, 42.43408778175858}}], 
      LineBox[{{-125., -16.611049523224892`}, {7.575, 44.95909816820078}}], 
      LineBox[{{-125., -16.571840717705193`}, {7.575, 
       47.60029445855926}}]}}}, {{{}, {}, 
     TagBox[
      {RGBColor[1, 0, 0], Thickness[Large], Opacity[1.], FaceForm[Opacity[
       0.3]], LineBox[CompressedData["
1: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
CA==
        "]]},
      Annotation[#, "Charting`Private`Tag$18643#1"]& ]}, {}}},
  PlotRange->{{-125., 7.575}, {-25., 25.}}]], "Output",
 CellChangeTimes->{
  3.8916811715640335`*^9, 3.8916815559100485`*^9, 3.8919234414277*^9, {
   3.892192893891829*^9, 3.892192898714327*^9}},
 CellLabel->"Out[38]=",ExpressionUUID->"d38c64a4-49a3-455d-98b0-e6d4b477aded"],

Cell[BoxData["\<\"/Users/rodrigo/Documents/Research/CHIDO/pyPSFstack/figures/\
best_focus/IntAirOil.pdf\"\>"], "Output",
 CellChangeTimes->{
  3.8916811715640335`*^9, 3.8916815559100485`*^9, 3.8919234414277*^9, {
   3.892192893891829*^9, 3.8921928988949623`*^9}},
 CellLabel->"Out[39]=",ExpressionUUID->"24e7ca61-5fbe-41fe-95d0-e0888a73e72a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"nr", " ", "=", " ", "1.515"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"getParaxial", "[", "nr", "]"}], ",", 
     RowBox[{"getW4min", "[", "nr", "]"}], ",", 
     RowBox[{"getW6min", "[", "nr", "]"}], ",", 
     RowBox[{"getWmin", "[", "nr", "]"}], ",", 
     RowBox[{"get\[Epsilon]4min", "[", "nr", "]"}], ",", 
     RowBox[{"get\[Epsilon]6min", "[", "nr", "]"}], ",", 
     RowBox[{"getLeastConfusion", "[", 
      RowBox[{
       RowBox[{"1", "/", "nr"}], ",", "nr"}], "]"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8916788332798924`*^9, 3.891678833418463*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"bc1446a6-2b14-4bde-b37d-e61ce0e2efca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.515`", ",", "1.7088773245787936`", ",", "1.8292835897309436`", ",", 
   "2.142971305814088`", ",", "1.767276668415608`", ",", "1.961513746158919`",
    ",", "1.7351622444206216`"}], "}"}]], "Output",
 CellChangeTimes->{3.891678833850947*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"3b604dd6-e3b7-4de7-a9b3-b39e4e289b84"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{866, 821},
WindowMargins->{{Automatic, -1393}, {Automatic, -149}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ef2f5b5e-2279-4706-bbcf-6d2823d3669c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 180, 3, 98, "Title",ExpressionUUID->"59ad2c26-9444-4104-9425-54a8a1acfd9b"],
Cell[763, 27, 217, 5, 35, "Text",ExpressionUUID->"5ca0b3ac-9e01-4482-8a25-4c1cdde36ed0"],
Cell[983, 34, 1793, 57, 127, "Input",ExpressionUUID->"14fe8ff0-3b7c-4a1e-bd23-fef16bcbffcf"],
Cell[CellGroupData[{
Cell[2801, 95, 415, 10, 30, "Input",ExpressionUUID->"66ac7375-ea5d-498e-8148-de3ddeb1acbc"],
Cell[3219, 107, 1495, 43, 57, "Output",ExpressionUUID->"3b25f9de-1187-4e00-ac47-620e54f5bf64"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4751, 155, 182, 3, 45, "Subsubsection",ExpressionUUID->"13ac0d7c-0ed8-4d26-bdc7-87ecd94901ef"],
Cell[4936, 160, 234, 4, 30, "Input",ExpressionUUID->"1ab65db4-53b6-4a60-9495-bc514c00fbd5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5207, 169, 171, 3, 45, "Subsubsection",ExpressionUUID->"65b9b499-f0a9-4327-a3e0-4618a0d1dbdf"],
Cell[5381, 174, 284, 6, 35, "Text",ExpressionUUID->"a8514146-93fb-4d68-b2c0-1cbcb21865e2"],
Cell[5668, 182, 2118, 57, 100, "Input",ExpressionUUID->"994c56db-ceb1-430c-90e5-8a7e477a6aad"],
Cell[CellGroupData[{
Cell[7811, 243, 904, 25, 54, "Input",ExpressionUUID->"293c7c6d-2c1d-45d8-9054-93fd15597ae1"],
Cell[8718, 270, 802, 22, 57, "Output",ExpressionUUID->"5b9aba51-b12b-46ad-a409-51b85385daeb"]
}, Open  ]],
Cell[9535, 295, 737, 20, 59, "Input",ExpressionUUID->"54acec7e-2b97-4ab2-872f-f1ff48590824"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10309, 320, 219, 4, 45, "Subsubsection",ExpressionUUID->"37b5d299-314e-4585-a1d3-aa7a6be58f39"],
Cell[10531, 326, 284, 6, 35, "Text",ExpressionUUID->"fb2a9487-6401-47a2-9e40-b5f4fea6ecda"],
Cell[10818, 334, 2168, 58, 100, "Input",ExpressionUUID->"db495f1e-9eb7-4c1a-926a-8aba5a8f0cca"],
Cell[CellGroupData[{
Cell[13011, 396, 904, 25, 54, "Input",ExpressionUUID->"82617b78-4e31-4e40-a174-d8c839fa96f7"],
Cell[13918, 423, 1117, 30, 62, "Output",ExpressionUUID->"4d1e9684-2a79-4e8a-b1f6-ee295f566231"]
}, Open  ]],
Cell[15050, 456, 975, 26, 59, "Input",ExpressionUUID->"e6bc147d-1a10-454a-8120-84adedb69cf3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16062, 487, 164, 3, 45, "Subsubsection",ExpressionUUID->"3e522d5a-85c7-41ac-8bd2-fa60fb856b6d"],
Cell[16229, 492, 2106, 57, 100, "Input",ExpressionUUID->"afa24e15-5599-4999-ae48-a908441cd4c6"],
Cell[CellGroupData[{
Cell[18360, 553, 787, 23, 54, "Input",ExpressionUUID->"57e1a391-a61f-486d-add8-c822a794492e"],
Cell[19150, 578, 1784, 52, 73, "Output",ExpressionUUID->"da0aa79a-c1f6-4183-88b2-293ad6002297"]
}, Open  ]],
Cell[20949, 633, 1466, 48, 64, "Input",ExpressionUUID->"6da59478-de27-411c-be10-ee9c7a46fe32"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22452, 686, 224, 4, 45, "Subsubsection",ExpressionUUID->"6e662ed9-a15c-41fa-ab5b-924c06727112"],
Cell[22679, 692, 2085, 60, 108, "Input",ExpressionUUID->"31b9ccf5-4978-4b73-935c-fe8a067f3b18"],
Cell[CellGroupData[{
Cell[24789, 756, 673, 19, 30, "Input",ExpressionUUID->"f9909284-5920-4f40-aa95-deb81e529274"],
Cell[25465, 777, 748, 21, 57, "Output",ExpressionUUID->"89b0442e-5024-46cd-b15a-b36bff679e5e"]
}, Open  ]],
Cell[26228, 801, 638, 17, 54, "Input",ExpressionUUID->"c76a3a6d-52d9-45ee-963d-099d024e50d0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26903, 823, 264, 4, 45, "Subsubsection",ExpressionUUID->"35d66903-84b7-4229-9b1d-13f705402a03"],
Cell[27170, 829, 2106, 60, 108, "Input",ExpressionUUID->"d9d05580-2c2c-42b7-b948-5178c5d821bf"],
Cell[CellGroupData[{
Cell[29301, 893, 605, 18, 30, "Input",ExpressionUUID->"fcf2239e-66f2-41b2-a068-326f23d59bba"],
Cell[29909, 913, 800, 24, 57, "Output",ExpressionUUID->"4b7dad52-7989-422d-982e-35bbdb87fa05"]
}, Open  ]],
Cell[30724, 940, 917, 24, 54, "Input",ExpressionUUID->"4cb4401c-2774-48ae-96e0-2e2f7d40869d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31678, 969, 159, 3, 45, "Subsubsection",ExpressionUUID->"1c7fc80f-639e-4ad9-abfc-8cd4176b12a0"],
Cell[31840, 974, 1750, 49, 113, "Input",ExpressionUUID->"14562c5e-b1f5-427c-b07c-11cc23df7da8"],
Cell[33593, 1025, 258, 6, 35, "Text",ExpressionUUID->"5b25d158-ee6d-4638-8de0-5b3651053232"],
Cell[33854, 1033, 1589, 46, 148, "Input",ExpressionUUID->"b142235b-8962-495a-a165-532e034c2a47"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35480, 1084, 189, 4, 54, "Subsection",ExpressionUUID->"e4442799-526a-4e22-a5c1-742ba2eafc46"],
Cell[CellGroupData[{
Cell[35694, 1092, 1248, 25, 73, "Input",ExpressionUUID->"7afc98e7-8467-4cd9-8c95-1c11c819cd8a"],
Cell[36945, 1119, 818, 14, 34, "Output",ExpressionUUID->"2dad1d7b-e5c9-4d76-b3e9-3b7b67237666"]
}, Open  ]],
Cell[37778, 1136, 14940, 345, 918, "Input",ExpressionUUID->"89d5599d-cd68-427b-891b-fa0f52a3a4f6"],
Cell[CellGroupData[{
Cell[52743, 1485, 516, 10, 30, "Input",ExpressionUUID->"cf9ade2b-92f7-4145-8a4c-f48c75d920ab"],
Cell[53262, 1497, 354, 5, 34, "Output",ExpressionUUID->"9df4fad1-8dc5-4d1e-a7c2-6d56cb7a7d01"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53653, 1507, 578, 12, 52, "Input",ExpressionUUID->"5ba6ca9b-1cc6-4c9a-b10d-8dc8dec51970"],
Cell[54234, 1521, 14768, 274, 155, "Output",ExpressionUUID->"4bff6731-ee2d-4711-80e2-97f2e94b1e04"],
Cell[69005, 1797, 442, 6, 82, "Output",ExpressionUUID->"1715bdb8-ee00-4e0f-9f6f-79d2dd372441"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69484, 1808, 739, 19, 73, "Input",ExpressionUUID->"56f97bdd-d924-4d11-acd9-757238c1ab38"],
Cell[70226, 1829, 383, 8, 34, "Output",ExpressionUUID->"41a65c01-ea3d-40f0-93ac-539e12935d1f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70646, 1842, 521, 11, 52, "Input",ExpressionUUID->"1311847e-f1a2-4cb4-8c96-4559d0d3d1e4"],
Cell[71170, 1855, 13577, 224, 153, "Output",ExpressionUUID->"d38c64a4-49a3-455d-98b0-e6d4b477aded"],
Cell[84750, 2081, 342, 5, 34, "Output",ExpressionUUID->"24e7ca61-5fbe-41fe-95d0-e0888a73e72a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85129, 2091, 774, 18, 73, "Input",ExpressionUUID->"bc1446a6-2b14-4bde-b37d-e61ce0e2efca"],
Cell[85906, 2111, 365, 7, 34, "Output",ExpressionUUID->"3b604dd6-e3b7-4de7-a9b3-b39e4e289b84"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

